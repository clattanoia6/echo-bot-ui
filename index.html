<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#000000">
    <title>Unsaid Echo MiniApp 2.0</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- ç«‹å³åˆå§‹åŒ– Telegram WebApp -->
    <script>
        // åœ¨é¡µé¢åŠ è½½æ—¶ç«‹å³è°ƒç”¨ ready()
        if (typeof window !== 'undefined' && window.Telegram && window.Telegram.WebApp) {
            window.Telegram.WebApp.ready();
            console.log('âœ“ Telegram WebApp initialized');
        }
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #000000;
            color: #ffffff;
            overflow-x: hidden;
            /* å®‰å…¨åŒºåŸŸé€‚é… - iPhone åˆ˜æµ·å±å’Œåº•éƒ¨æ¨ªæ¡ */
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
        }

        .mono {
            font-family: 'JetBrains Mono', 'Courier New', monospace;
        }

        /* æ¯›ç»ç’ƒæ•ˆæœ - ç¡…è°·ç²¾å“é£æ ¼ */
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .glass-strong {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* æ‰«æåŠ¨æ•ˆ */
        @keyframes scan {
            0% {
                transform: translateX(-100%);
            }
            100% {
                transform: translateX(100%);
            }
        }

        .scan-animation {
            position: relative;
            overflow: hidden;
        }

        .scan-animation::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(6, 182, 212, 0.3),
                transparent
            );
            animation: scan 2s infinite;
        }

        /* è¾“å…¥æ¡†æ‰«ææµè½¬åŠ¨ç”» - å†°è“è‰²æ‰«ææ•ˆæœ */
        @keyframes inputScan {
            0% {
                border-color: rgba(6, 182, 212, 0.3);
                box-shadow: 0 0 0 0 rgba(6, 182, 212, 0.2);
            }
            25% {
                border-color: rgba(6, 182, 212, 0.6);
                box-shadow: 0 0 10px rgba(6, 182, 212, 0.4), 0 0 20px rgba(6, 182, 212, 0.2);
            }
            50% {
                border-color: rgba(6, 182, 212, 0.9);
                box-shadow: 0 0 15px rgba(6, 182, 212, 0.6), 0 0 30px rgba(6, 182, 212, 0.3);
            }
            75% {
                border-color: rgba(6, 182, 212, 0.6);
                box-shadow: 0 0 10px rgba(6, 182, 212, 0.4), 0 0 20px rgba(6, 182, 212, 0.2);
            }
            100% {
                border-color: rgba(6, 182, 212, 0.3);
                box-shadow: 0 0 0 0 rgba(6, 182, 212, 0.2);
            }
        }

        /* è¾“å…¥æ¡†æ‰«ææ•ˆæœç±» */
        .input-scan-effect:focus {
            animation: inputScan 2s infinite ease-in-out;
            border-color: rgba(6, 182, 212, 0.5);
        }

        /* èƒ½é‡å¹³è¡¡ä»ªåŠ¨ç”» */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        .energy-pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        /* åˆ†æ®µé€‰æ‹©å™¨æ ·å¼ - ç¡…è°·ç²¾å“é£æ ¼ */
        .segment-container {
            display: flex;
            flex-wrap: wrap; /* å…è®¸æ¢è¡Œ */
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 6px;
            gap: 6px;
            justify-content: flex-start; /* å·¦å¯¹é½ */
        }

        .segment-option {
            /* ç§»é™¤ flex: 1ï¼Œè®©æŒ‰é’®è‡ªé€‚åº”å†…å®¹å®½åº¦ */
            min-width: 60px; /* æœ€å°å®½åº¦ */
            width: auto; /* å®½åº¦è‡ªé€‚åº”å†…å®¹ */
            padding: 10px 16px; /* é€‚å½“å‡å°å†…è¾¹è·ä»¥é€‚åº”å°å±å¹• */
            border-radius: 12px;
            text-align: center;
            font-size: 13px; /* ç¨å¾®å‡å°å­—ä½“ */
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            background: transparent;
            color: rgba(255, 255, 255, 0.6);
            border: none;
            position: relative;
            white-space: nowrap; /* é˜²æ­¢æ–‡å­—æ¢è¡Œ */
            flex-shrink: 0; /* é˜²æ­¢æ”¶ç¼© */
            pointer-events: auto !important; /* ç¡®ä¿å¯ç‚¹å‡» */
            z-index: 100 !important; /* æé«˜å±‚çº§ï¼Œç¡®ä¿åœ¨ä¸Šå±‚ */
            touch-action: manipulation; /* ä¼˜åŒ–ç§»åŠ¨ç«¯è§¦æ‘¸ */
            -webkit-tap-highlight-color: rgba(6, 182, 212, 0.3); /* iOS ç‚¹å‡»é«˜äº® */
            user-select: none; /* é˜²æ­¢æ–‡æœ¬é€‰æ‹© */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        .segment-option:active {
            transform: scale(0.95);
        }

        .segment-option.active {
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.15), rgba(8, 145, 178, 0.1));
            color: #ffffff;
            box-shadow: 0 0 15px rgba(0, 209, 255, 0.4);
            border: 1px solid rgba(6, 182, 212, 0.3);
        }

        /* åº•éƒ¨å¯¼èˆªæ  - ç¡…è°·ç²¾å“é£æ ¼ */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 16px 0 calc(16px + env(safe-area-inset-bottom));
            z-index: 100;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            flex: 1;
            padding: 10px;
            color: rgba(255, 255, 255, 0.5);
            transition: all 0.3s ease;
            background: none;
            border: none;
            cursor: pointer;
        }

        .nav-item:active {
            transform: scale(0.95);
        }

        .nav-item.active {
            color: #06b6d4;
        }

        .nav-item.active .nav-item-icon {
            filter: drop-shadow(0 0 8px rgba(6, 182, 212, 0.6));
            transform: scale(1.1);
        }

        .nav-item-icon {
            font-size: 24px;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .nav-item-label {
            font-size: 9px;
            font-weight: 500;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        /* é¡µé¢å®¹å™¨ - å¢åŠ å‘¼å¸æ„Ÿ */
        .page {
            display: none;
            padding: 24px;
            padding-top: calc(24px + env(safe-area-inset-top)); /* é€‚é…é¡¶éƒ¨å®‰å…¨åŒºåŸŸ */
            padding-bottom: calc(120px + env(safe-area-inset-bottom)); /* é€‚é…åº•éƒ¨å®‰å…¨åŒºåŸŸ */
            padding-left: calc(24px + env(safe-area-inset-left)); /* é€‚é…å·¦ä¾§å®‰å…¨åŒºåŸŸ */
            padding-right: calc(24px + env(safe-area-inset-right)); /* é€‚é…å³ä¾§å®‰å…¨åŒºåŸŸ */
            min-height: 100vh;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .page.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        /* é¡µé¢æ·¡å…¥åŠ¨ç”»ï¼ˆé¦–æ¬¡åŠ è½½ï¼‰ */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .page.active:first-child {
            animation: fadeInUp 0.4s ease-out;
        }

        /* å¡ç‰‡æ ·å¼ - ç¡…è°·ç²¾å“ç»ç’ƒæ‹Ÿæ€ */
        .card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 20px;
        }

        /* æŒ‰é’®æ ·å¼ - ç¡…è°·ç²¾å“é£æ ¼ */
        .btn-primary {
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.2), rgba(8, 145, 178, 0.15));
            color: #ffffff;
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 16px;
            padding: 18px 28px;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(6, 182, 212, 0.2);
        }

        .btn-primary:hover {
            box-shadow: 0 0 25px rgba(6, 182, 212, 0.4);
            border-color: rgba(6, 182, 212, 0.5);
        }

        .btn-primary:active {
            transform: scale(0.95);
        }

        .btn-secondary {
            background: rgba(245, 158, 11, 0.1);
            color: #f59e0b;
            border: 1px solid rgba(245, 158, 11, 0.2);
            border-radius: 16px;
            padding: 14px 22px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .btn-secondary:hover {
            background: rgba(245, 158, 11, 0.15);
            border-color: rgba(245, 158, 11, 0.4);
            box-shadow: 0 0 15px rgba(245, 158, 11, 0.2);
        }

        .btn-secondary:active {
            transform: scale(0.95);
        }

        /* è¾“å…¥æ¡†æ ·å¼ - ç¡…è°·ç²¾å“é£æ ¼ */
        .input-field {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 14px 18px;
            color: #ffffff;
            font-size: 14px;
            width: 100%;
            margin-bottom: 16px;
        }

        .input-field:focus {
            outline: none;
            border-color: #06b6d4;
            box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.1);
        }

        /* èƒ½é‡å¹³è¡¡ä»ª */
        .energy-meter {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 20px;
        }

        .energy-bar {
            flex: 1;
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            overflow: hidden;
            position: relative;
        }

        .energy-fill {
            height: 100%;
            background: linear-gradient(90deg, #06b6d4, #f59e0b);
            border-radius: 16px;
            transition: width 0.3s;
        }

        /* é‚€è¯·ç å¤åˆ¶åŒº - ç¡…è°·ç²¾å“é£æ ¼ */
        .invite-code {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 18px;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(6, 182, 212, 0.2);
            border-radius: 16px;
            font-family: 'JetBrains Mono', monospace;
        }

        .copy-btn {
            background: rgba(6, 182, 212, 0.15);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 16px;
            padding: 10px 18px;
            color: #06b6d4;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .copy-btn:hover {
            background: rgba(6, 182, 212, 0.2);
            box-shadow: 0 0 12px rgba(6, 182, 212, 0.3);
        }

        .copy-btn:active {
            transform: scale(0.95);
        }

        /* å……å€¼å¡ç‰‡ - ç¡…è°·ç²¾å“é£æ ¼ */
        .recharge-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        .stars-icon {
            font-size: 24px;
            margin-right: 8px;
        }

        /* å‘¼å¸ç¯è¾¹æ¡†æ•ˆæœï¼ˆçµé­‚æ‹†è§£æŒ‰é’®ï¼‰ */
        @keyframes pulseBorder {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(6, 182, 212, 0.8),
                            0 0 0 0 rgba(6, 182, 212, 0.5);
                border-color: #06b6d4;
            }
            50% {
                box-shadow: 0 0 0 4px rgba(6, 182, 212, 0),
                            0 0 0 8px rgba(6, 182, 212, 0);
                border-color: #22d3ee;
            }
        }

        .btn-soul-dissection {
            position: relative;
            border: 2px solid #06b6d4 !important;
            animation: pulseBorder 2s ease-in-out infinite;
        }

        /* åŠ¨æ€æ‰«æçº¿æ•ˆæœ - æƒ…æŠ¥æ‹¦æˆªæ‰«æè´¨æ„Ÿ */
        @keyframes scanLine {
            0% {
                top: 0;
                opacity: 0;
            }
            5% {
                opacity: 1;
            }
            95% {
                opacity: 1;
            }
            100% {
                top: 100%;
                opacity: 0;
            }
        }

        .scan-line {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(
                90deg,
                transparent 0%,
                rgba(6, 182, 212, 0.05) 20%,
                rgba(6, 182, 212, 0.15) 50%,
                rgba(6, 182, 212, 0.05) 80%,
                transparent 100%
            );
            box-shadow: 
                0 0 8px rgba(6, 182, 212, 0.4),
                0 0 16px rgba(6, 182, 212, 0.2),
                inset 0 0 4px rgba(6, 182, 212, 0.3);
            z-index: 1; /* é™ä½å±‚çº§ï¼Œé¿å…é®æŒ¡ */
            pointer-events: none !important; /* ç¡®ä¿ä¸æ‹¦æˆªç‚¹å‡»äº‹ä»¶ */
            animation: scanLine 4s linear infinite;
            will-change: top, opacity;
        }

        /* Instagram é£æ ¼çš„ç›®æ ‡å¡ç‰‡ - ç¡…è°·ç²¾å“é£æ ¼ */
        .target-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .target-card:active {
            transform: scale(0.98);
        }

        .target-card:hover {
            border-color: rgba(6, 182, 212, 0.3);
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.1);
        }

        /* çŠ¶æ€æ ‡ç­¾ */
        .status-badge {
            position: absolute;
            top: 16px;
            right: 16px;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: flex;
            align-items: center;
            gap: 6px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .status-live {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid rgba(239, 68, 68, 0.3);
        }

        .status-archived {
            background: rgba(107, 114, 128, 0.2);
            color: #9ca3af;
            border: 1px solid rgba(107, 114, 128, 0.3);
        }

        /* é—ªçƒçº¢ç‚¹ */
        @keyframes blink {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.3;
            }
        }

        .live-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #ef4444;
            box-shadow: 0 0 8px rgba(239, 68, 68, 0.8);
            animation: blink 1.5s ease-in-out infinite;
        }

        /* å¡ç‰‡å†…å®¹ */
        .target-card-header {
            display: flex;
            align-items: center;
            gap: 14px;
            margin-bottom: 16px;
            padding-right: 90px;
        }

        .target-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(6, 182, 212, 0.2), rgba(8, 145, 178, 0.15));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
            position: relative;
            box-shadow: 0 0 10px rgba(6, 182, 212, 0.3), 
                        0 0 20px rgba(6, 182, 212, 0.2),
                        inset 0 0 10px rgba(6, 182, 212, 0.1);
            animation: avatarGlow 3s ease-in-out infinite;
        }

        /* å¤´åƒç§‘æŠ€æ„Ÿå‘å…‰åŠ¨ç”» */
        @keyframes avatarGlow {
            0%, 100% {
                box-shadow: 0 0 10px rgba(6, 182, 212, 0.3), 
                            0 0 20px rgba(6, 182, 212, 0.2),
                            inset 0 0 10px rgba(6, 182, 212, 0.1);
            }
            50% {
                box-shadow: 0 0 15px rgba(6, 182, 212, 0.5), 
                            0 0 30px rgba(6, 182, 212, 0.3),
                            inset 0 0 15px rgba(6, 182, 212, 0.2);
            }
        }

        .target-info {
            flex: 1;
            min-width: 0;
        }

        .target-name {
            font-size: 16px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 4px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .target-meta {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
        }

        /* ä¸»å¯¼æƒæŒ‡æ•°è¿›åº¦æ¡ */
        .dominance-preview {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .dominance-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
        }

        .dominance-value {
            font-weight: 600;
            color: #06b6d4;
            font-family: 'JetBrains Mono', monospace;
        }

        .dominance-bar {
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            overflow: hidden;
            position: relative;
        }

        .dominance-fill {
            height: 100%;
            background: linear-gradient(90deg, #06b6d4, #22d3ee);
            border-radius: 16px;
            transition: width 0.3s ease;
            box-shadow: 0 0 8px rgba(6, 182, 212, 0.5);
        }

        /* ç©ºçŠ¶æ€ */
        .empty-archives {
            text-align: center;
            padding: 60px 20px;
            color: rgba(255, 255, 255, 0.4);
        }

        .empty-archives-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-archives-text {
            font-size: 14px;
            margin-bottom: 8px;
        }

        .empty-archives-hint {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.3);
        }

        /* å¼¹çª—æ ·å¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
        }

        .modal-overlay.hidden {
            display: none;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
        }

        /* å“åº”å¼æ–‡æœ¬å¤„ç† - é˜²æ­¢é•¿æ–‡æœ¬æº¢å‡º */
        /* æ³¨æ„ï¼šè¿™ä¸ªæ ·å¼å·²ç»è¢«ä¸Šé¢çš„ .segment-option è¦†ç›–ï¼Œä¿ç•™ç”¨äºå…¼å®¹æ€§ */

        .nav-item-label {
            word-break: break-word;
            overflow-wrap: break-word;
            white-space: nowrap;
            text-overflow: ellipsis;
            max-width: 100%;
        }

        .target-name {
            word-break: break-word;
            overflow-wrap: break-word;
        }

        .target-meta {
            word-break: break-word;
            overflow-wrap: break-word;
        }

        /* ç¡®ä¿æŒ‰é’®æ–‡æœ¬ä¸ä¼šæº¢å‡º */
        .btn-primary, .btn-secondary {
            word-break: break-word;
            overflow-wrap: break-word;
            white-space: normal;
        }

        /* ç¡®ä¿æ ‡ç­¾æ–‡æœ¬ä¸ä¼šæº¢å‡º */
        label {
            word-break: break-word;
            overflow-wrap: break-word;
        }

        /* è‡ªå®šä¹‰è¾“å…¥æ¡†æ ·å¼ - æƒ…æŠ¥å±€æš—é»‘é£æ ¼ */
        .custom-input-container {
            margin-top: 12px;
            display: none;
            animation: slideDown 0.3s ease-out;
        }

        .custom-input-container.active {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .custom-input-field {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 16px;
            padding: 14px 18px;
            color: #ffffff;
            font-size: 14px;
            width: 100%;
            transition: all 0.3s ease;
        }

        .custom-input-field:focus {
            outline: none;
            border-color: #06b6d4;
            box-shadow: 0 0 15px rgba(6, 182, 212, 0.3);
            background: rgba(255, 255, 255, 0.12);
        }

        .custom-input-field::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        /* è‡ªå®šä¹‰æŒ‰é’®æ ·å¼ */
        .segment-option.custom-btn {
            border: 1px dashed rgba(6, 182, 212, 0.4);
            background: rgba(6, 182, 212, 0.05);
        }

        .segment-option.custom-btn.active {
            background: rgba(6, 182, 212, 0.15);
            border-color: rgba(6, 182, 212, 0.6);
            box-shadow: 0 0 15px rgba(6, 182, 212, 0.3);
        }

        /* ==================== æƒ…æŠ¥è§£å¯†åŠ è½½åŠ¨ç”»æ ·å¼ ==================== */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            z-index: 99999;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }

        .loading-overlay:not(.hidden) {
            opacity: 1;
            pointer-events: all;
        }

        .loading-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* æ‰«æå…‰æŸ */
        .scan-beam {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(0, 255, 0, 0.8), 
                rgba(6, 182, 212, 0.8), 
                rgba(0, 255, 0, 0.8), 
                transparent
            );
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.6), 0 0 20px rgba(6, 182, 212, 0.4);
            animation: scanBeam 2s linear infinite;
        }

        @keyframes scanBeam {
            0% {
                transform: translateY(0);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh);
                opacity: 0.3;
            }
        }

        /* åå…­è¿›åˆ¶ä»£ç æµå®¹å™¨ */
        .hex-stream-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            opacity: 0.15;
        }

        .hex-stream {
            position: absolute;
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 12px;
            color: rgba(6, 182, 212, 0.6);
            white-space: nowrap;
            animation: hexStreamFlow 8s linear infinite;
        }

        #hexStream1 {
            top: 10%;
            left: -100%;
            animation-delay: 0s;
        }

        #hexStream2 {
            top: 50%;
            left: -100%;
            animation-delay: 2s;
        }

        #hexStream3 {
            top: 80%;
            left: -100%;
            animation-delay: 4s;
        }

        @keyframes hexStreamFlow {
            0% {
                transform: translateX(0);
            }
            100% {
                transform: translateX(calc(100vw + 100%));
            }
        }

        /* ä¸­å¿ƒå†…å®¹ */
        .loading-content {
            position: relative;
            z-index: 10;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 24px;
        }

        .decrypting-text {
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 18px;
            font-weight: 600;
            color: #06b6d4;
            text-shadow: 0 0 8px rgba(0, 209, 255, 0.8), 
                         0 0 16px rgba(6, 182, 212, 0.6),
                         0 0 24px rgba(6, 182, 212, 0.4);
            letter-spacing: 2px;
        }

        .security-bypass {
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 14px;
            font-weight: 500;
            color: #06b6d4;
            text-shadow: 0 0 6px rgba(0, 209, 255, 0.6), 
                         0 0 12px rgba(6, 182, 212, 0.4);
            letter-spacing: 1px;
        }

        .security-bypass span {
            color: #22d3ee;
            font-weight: 700;
        }

        /* è‡ªå®šä¹‰è¾“å…¥å¼¹çª—æ ·å¼ */
        .custom-input-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .custom-input-modal.show {
            opacity: 1;
            pointer-events: all;
        }

        .custom-input-modal-content {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
            max-width: 90%;
            width: 400px;
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .custom-input-modal.show .custom-input-modal-content {
            transform: translateY(0);
        }

        .custom-input-modal-title {
            font-size: 16px;
            font-weight: 600;
            color: #06b6d4;
            margin-bottom: 16px;
            font-family: 'JetBrains Mono', monospace;
        }

        .custom-input-modal-input {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(6, 182, 212, 0.3);
            border-radius: 12px;
            color: #ffffff;
            font-size: 14px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
        }

        .custom-input-modal-input:focus {
            outline: none;
            border-color: #06b6d4;
            box-shadow: 0 0 15px rgba(6, 182, 212, 0.3);
            background: rgba(255, 255, 255, 0.12);
        }

        .custom-input-modal-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .custom-input-modal-buttons {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .custom-input-modal-btn {
            padding: 10px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .custom-input-modal-btn-cancel {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.7);
        }

        .custom-input-modal-btn-cancel:hover {
            background: rgba(255, 255, 255, 0.15);
            color: #ffffff;
        }

        .custom-input-modal-btn-confirm {
            background: linear-gradient(135deg, #06b6d4, #0891b2);
            color: #ffffff;
        }

        .custom-input-modal-btn-confirm:hover {
            background: linear-gradient(135deg, #0891b2, #0e7490);
            box-shadow: 0 0 15px rgba(6, 182, 212, 0.4);
        }

        /* ==================== æƒ…æŠ¥è§£å¯†å…¨å±é®ç½©å±‚æ ·å¼ ==================== */
        .decrypt-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            z-index: 99999;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.5s ease;
            pointer-events: none;
        }

        .decrypt-overlay:not(.hidden) {
            opacity: 1;
            pointer-events: all;
        }

        .decrypt-overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* ç»¿è‰²æ¿€å…‰æ‰«æçº¿ */
        .decrypt-scan-line {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(0, 255, 0, 1), 
                rgba(0, 255, 0, 0.8), 
                rgba(0, 255, 0, 1), 
                transparent
            );
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.8), 
                        0 0 30px rgba(0, 255, 0, 0.6),
                        0 0 45px rgba(0, 255, 0, 0.4);
            animation: decryptScanLine 2s linear infinite;
        }

        @keyframes decryptScanLine {
            0% {
                transform: translateY(0);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh);
                opacity: 0.5;
            }
        }

        /* ä¸­å¿ƒå†…å®¹ */
        .decrypt-content {
            position: relative;
            z-index: 10;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 32px;
        }

        /* ä¿¡å·è·³åŠ¨ */
        .decrypt-signal {
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 20px;
            font-weight: 600;
            color: #00d1ff;
            text-shadow: 0 0 10px rgba(0, 209, 255, 1), 
                         0 0 20px rgba(0, 209, 255, 0.8),
                         0 0 30px rgba(0, 209, 255, 0.6),
                         0 0 40px rgba(0, 209, 255, 0.4);
            letter-spacing: 3px;
            animation: signalPulse 1.5s ease-in-out infinite;
        }

        @keyframes signalPulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.7;
                transform: scale(1.05);
            }
        }

        /* å­—ç¬¦æ··æ·†åŒºåŸŸ */
        .decrypt-scramble {
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 24px;
            font-weight: 700;
            color: #00d1ff;
            text-shadow: 0 0 12px rgba(0, 209, 255, 1), 
                         0 0 24px rgba(0, 209, 255, 0.8),
                         0 0 36px rgba(0, 209, 255, 0.6);
            letter-spacing: 4px;
            min-height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* è¿›åº¦æ•°æ® */
        .decrypt-progress {
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 16px;
            font-weight: 500;
            color: #00d1ff;
            text-shadow: 0 0 8px rgba(0, 209, 255, 0.8), 
                         0 0 16px rgba(0, 209, 255, 0.6);
            letter-spacing: 2px;
        }

        .decrypt-progress span {
            color: #00d1ff;
            font-weight: 700;
            text-shadow: 0 0 10px rgba(0, 209, 255, 1), 
                         0 0 20px rgba(0, 209, 255, 0.8);
        }

        /* ==================== æ ‡ç­¾å®¹å™¨è‡ªåŠ¨æ¢è¡Œæ ·å¼ ==================== */
        /* ç¡®ä¿å®¹å™¨å†…çš„æ ‡ç­¾å¯ä»¥è‡ªåŠ¨æ¢è¡Œï¼Œä¸å†æ˜¾ç¤º ... */
        .relationship-container, .stage-container,
        .segment-container {
            display: flex;
            flex-wrap: wrap; /* å…è®¸æ¢è¡Œ */
            gap: 10px;      /* æ ‡ç­¾ä¹‹é—´çš„é—´è· */
            justify-content: space-around;
        }

        .tag-item,
        .segment-option {
            min-width: 60px; /* æœ€å°å®½åº¦ */
            width: auto;     /* å®½åº¦è‡ªé€‚åº”å†…å®¹ */
            padding: 8px 12px;
            font-size: 14px; /* é€‚å½“è°ƒå°å­—ä½“ */
            white-space: normal; /* å…è®¸æ–‡å­—åœ¨å†…éƒ¨æ¢è¡Œ */
            text-align: center;
        }

        /* ç¡®ä¿æŒ‰é’®åœ¨æœ€ä¸Šå±‚ä¸”å¯ç‚¹å‡» */
        #start-analysis-btn,
        #confirmBtn {
            position: relative;
            z-index: 10;
            pointer-events: auto !important;
        }

        /* ç¡®ä¿æ‰€æœ‰å¯äº¤äº’å…ƒç´ å¯ç‚¹å‡» */
        button, .segment-option, .nav-item, .btn-primary, .btn-secondary {
            pointer-events: auto !important;
            touch-action: manipulation !important; /* ä¼˜åŒ–ç§»åŠ¨ç«¯è§¦æ‘¸ */
            -webkit-tap-highlight-color: rgba(6, 182, 212, 0.3); /* iOS ç‚¹å‡»é«˜äº® */
            user-select: none; /* é˜²æ­¢æ–‡æœ¬é€‰æ‹© */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        /* ç¡®ä¿å®¹å™¨ä¸ä¼šé˜»æ­¢ç‚¹å‡»äº‹ä»¶ */
        .segment-container {
            pointer-events: auto !important;
            position: relative;
            z-index: 10;
        }

        .card {
            pointer-events: auto !important;
            position: relative;
            z-index: 5;
        }

        .page {
            pointer-events: auto !important;
            position: relative;
            z-index: 1;
        }

        /* ç¡®ä¿æ²¡æœ‰é€æ˜å±‚é®æŒ¡ */
        .modal-overlay.hidden,
        .loading-overlay.hidden,
        .decrypt-overlay.hidden {
            pointer-events: none !important;
        }

        .modal-overlay:not(.hidden),
        .loading-overlay:not(.hidden),
        .decrypt-overlay:not(.hidden) {
            pointer-events: all;
        }
    </style>
</head>
<body>
    <!-- åŠ¨æ€æ‰«æçº¿ -->
    <div class="scan-line"></div>
    <!-- åšå¼ˆé¡µé¢ (é¦–é¡µ) -->
    <div class="page active" id="page-target">
        <div class="card">
            <h2 class="mono text-xl font-semibold mb-8 text-cyan-400" data-i18n="page_title_config">ğŸ¯ åšå¼ˆé…ç½®</h2>

            <!-- å…³ç³»ç±»å‹é€‰æ‹©å™¨ -->
            <div class="mb-8">
                <label class="block text-sm font-medium mb-4 text-gray-300" data-i18n="label_relationship">å…³ç³»ç±»å‹</label>
                <div class="segment-container">
                    <button class="segment-option active" data-type="relationship" data-value="lover" data-i18n="relationship_lover">æƒ…ä¾£</button>
                    <button class="segment-option" data-type="relationship" data-value="ex" data-i18n="relationship_ex">å‰ä»»</button>
                    <button class="segment-option" data-type="relationship" data-value="boss" data-i18n="relationship_boss">ä¸Šå¸</button>
                    <button class="segment-option" data-type="relationship" data-value="colleague" data-i18n="relationship_colleague">åŒäº‹</button>
                    <button class="segment-option custom-btn" id="rel-custom-btn" data-type="relationship" data-value="custom">âœï¸ Custom</button>
            </div>
            </div>

            <!-- åšå¼ˆé˜¶æ®µé€‰æ‹©å™¨ -->
            <div class="mb-8">
                <label class="block text-sm font-medium mb-4 text-gray-300" data-i18n="label_stage">åšå¼ˆé˜¶æ®µ</label>
                <div class="segment-container">
                    <button class="segment-option active" data-type="stage" data-value="ambiguous" data-i18n="stage_ambiguous">æš§æ˜§</button>
                    <button class="segment-option" data-type="stage" data-value="cold" data-i18n="stage_cold">å†·æˆ˜</button>
                    <button class="segment-option" data-type="stage" data-value="harvest" data-i18n="stage_harvest">æ”¶å‰²</button>
                    <button class="segment-option custom-btn" id="stage-custom-btn" data-type="stage" data-value="custom">âœï¸ Custom</button>
                </div>
            </div>

            <!-- ç¡®è®¤æŒ‰é’®ï¼ˆå¼€å§‹åˆ†æï¼‰ -->
            <button class="btn-primary scan-animation btn-soul-dissection" id="confirmBtn">
                <span class="mono" data-i18n="btn_start_analysis">âš¡ å¼€å§‹åˆ†æ</span>
            </button>
    </div>

        <!-- çŠ¶æ€æç¤º -->
        <div class="card glass" id="statusCard" style="display: none;">
            <p class="text-sm text-gray-300" id="statusText"></p>
        </div>
    </div>

    <!-- æ¡£æ¡ˆé¡µé¢ -->
    <div class="page" id="page-folder">
        <h2 class="mono text-xl font-semibold mb-3 text-cyan-400" data-i18n="page_title_archives">ğŸ“ ç›®æ ‡æ¡£æ¡ˆ</h2>
        <p class="text-sm text-gray-400 mb-6" data-i18n="page_desc_archives">æŸ¥çœ‹å’Œç®¡ç†æ‚¨çš„åšå¼ˆç›®æ ‡æ¡£æ¡ˆ</p>
        <div id="targetList">
            <!-- å¡ç‰‡å°†é€šè¿‡ JavaScript åŠ¨æ€ç”Ÿæˆ -->
            <div class="empty-archives">
                <div class="empty-archives-icon">ğŸ“­</div>
                <div class="empty-archives-text" data-i18n="empty_archives">æš‚æ— ç›®æ ‡æ¡£æ¡ˆ</div>
                <div class="empty-archives-hint" data-i18n="empty_archives_hint">å¼€å§‹æ‚¨çš„ç¬¬ä¸€æ¬¡åšå¼ˆåˆ†æ</div>
            </div>
        </div>
    </div>

    <!-- ä¸ªäººä¸­å¿ƒé¡µé¢ -->
    <div class="page" id="page-user">
        <!-- èƒ½é‡å¹³è¡¡ä»ª -->
        <div class="card glass-strong">
            <h2 class="mono text-xl font-semibold mb-4 text-cyan-400" data-i18n="page_title_energy">âš¡ èƒ½é‡å¹³è¡¡ä»ª</h2>
            <div class="energy-meter">
                <div class="energy-bar">
                    <div class="energy-fill" id="energyFill" style="width: 75%"></div>
                </div>
                <span class="mono text-sm text-cyan-400" id="energyValue">75%</span>
            </div>
            <p class="text-xs text-gray-400 mt-2">
                <span data-i18n="energy_available">å½“å‰å¯ç”¨åˆ†ææ¬¡æ•°ï¼š</span>
                <span id="analysisCount">15</span> 
                <span data-i18n="energy_times">æ¬¡</span>
            </p>
        </div>

        <!-- åŠ å¯†é‚€è¯·ç  -->
        <div class="card">
            <h2 class="mono text-xl font-semibold mb-4 text-cyan-400" data-i18n="page_title_invite">ğŸ” åŠ å¯†é‚€è¯·ç </h2>
            <div class="invite-code">
                <span class="flex-1 mono text-sm" id="inviteCode">ECHO-XXXX-XXXX-XXXX</span>
                <button class="copy-btn" id="copyBtn" data-i18n="btn_copy">å¤åˆ¶</button>
            </div>
            <p class="text-xs text-gray-400 mt-3" data-i18n="invite_desc">åˆ†äº«æ­¤é‚€è¯·ç ç»™å¥½å‹ï¼ŒåŒæ–¹å‡å¯è·å¾—èƒ½é‡å¥–åŠ±</p>
        </div>

        <!-- å……å€¼å¡ç‰‡ -->
        <div class="card recharge-card">
            <h2 class="mono text-xl font-semibold mb-4 text-amber-400" data-i18n="page_title_recharge">ğŸ’ èƒ½é‡å……å€¼</h2>
            <p class="text-sm text-gray-300 mb-4" data-i18n="recharge_desc">ä½¿ç”¨ Telegram Stars å……å€¼èƒ½é‡</p>
            <div class="space-y-3">
                <button class="btn-secondary w-full" data-amount="100">
                    <span class="stars-icon">â­</span>
                    <span data-i18n="recharge_100">100 Stars - è·å¾— 10 æ¬¡åˆ†æ</span>
                </button>
                <button class="btn-secondary w-full" data-amount="500">
                    <span class="stars-icon">â­</span>
                    <span data-i18n="recharge_500">500 Stars - è·å¾— 60 æ¬¡åˆ†æ</span>
                </button>
                <button class="btn-secondary w-full" data-amount="1000">
                    <span class="stars-icon">â­</span>
                    <span data-i18n="recharge_1000">1000 Stars - è·å¾— 150 æ¬¡åˆ†æ</span>
                </button>
            </div>
        </div>

        <!-- ç”¨æˆ·ä¿¡æ¯ -->
        <div class="card glass">
            <h2 class="mono text-xl font-semibold mb-4 text-cyan-400" data-i18n="page_title_user">ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯</h2>
            <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                    <span class="text-gray-400" data-i18n="label_user_id">ç”¨æˆ·ID</span>
                    <span class="mono text-cyan-400" id="userId">-</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-400" data-i18n="label_register_time">æ³¨å†Œæ—¶é—´</span>
                    <span class="text-gray-300" id="registerTime">-</span>
                </div>
            </div>
        </div>
    </div>

    <!-- åº•éƒ¨å¯¼èˆªæ  -->
    <nav class="bottom-nav">
        <div class="flex">
            <button class="nav-item active" data-page="target">
                <span class="nav-item-icon">ğŸ¯</span>
                <span class="nav-item-label" data-i18n="nav_target">åšå¼ˆ</span>
            </button>
            <button class="nav-item" data-page="folder">
                <span class="nav-item-icon">ğŸ“</span>
                <span class="nav-item-label" data-i18n="nav_folder">æ¡£æ¡ˆ</span>
            </button>
            <button class="nav-item" data-page="user">
                <span class="nav-item-icon">ğŸ‘¤</span>
                <span class="nav-item-label" data-i18n="nav_user">ä¸­å¿ƒ</span>
            </button>
        </div>
    </nav>

    <!-- æ¡£æ¡ˆåˆå§‹åŒ–å¼¹çª— -->
    <div id="targetCreationModal" class="modal-overlay hidden">
        <div class="modal-content glass">
            <h3 class="mono text-xl font-semibold mb-4 text-cyan-400" data-i18n="target_creation_title">âœ¨ Archive Initialization</h3>
            <p class="text-sm text-gray-400 mb-6" data-i18n="target_creation_desc">Create an archive for your new prey to start the game.</p>

            <div class="mb-4">
                <label for="targetNameInput" class="block text-sm font-medium text-gray-300 mb-2" data-i18n="miniapp_target_name_label">Archive Name</label>
                <input type="text" id="targetNameInput" class="w-full p-3 rounded-lg bg-gray-800 text-white border border-gray-700 focus:ring-cyan-500 focus:border-cyan-500 input-scan-effect" placeholder="e.g., Ex-A, Boss, That Guy..." data-i18n-placeholder="target_name_placeholder" maxlength="20">
                <p id="targetNameError" class="text-red-400 text-xs mt-1 hidden" data-i18n="miniapp_target_name_error"></p>
            </div>

            <div class="mb-6">
                <label for="targetIconSelector" class="block text-sm font-medium text-gray-300 mb-2" data-i18n="miniapp_target_icon_label">Archive Icon</label>
                <div id="targetIconSelector" class="w-full p-3 rounded-lg bg-gray-800 text-white border border-gray-700 flex items-center justify-between cursor-pointer hover:bg-gray-700 transition-colors">
                    <span id="selectedIcon" class="text-2xl">ğŸ¯</span>
                    <span class="text-gray-400" data-i18n="miniapp_target_creation_select_icon_placeholder">Click to select icon</span>
                </div>
                <p id="targetIconError" class="text-red-400 text-xs mt-1 hidden" data-i18n="miniapp_target_icon_error"></p>
            </div>

            <div class="flex justify-end space-x-3">
                <button id="cancelTargetCreation" class="btn-secondary" data-i18n="miniapp_target_creation_cancel">Cancel</button>
                <button id="confirmTargetCreation" class="btn-primary" data-i18n="miniapp_target_creation_confirm">Confirm Create</button>
            </div>
        </div>
    </div>

    <!-- Emoji Picker Modal -->
    <div id="emojiPickerModal" class="modal-overlay hidden">
        <div class="modal-content glass" style="max-height: 80vh; overflow-y: auto;">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-cyan-400" data-i18n="miniapp_target_creation_icon_picker_title">Select an Icon</h3>
                <button id="closeEmojiPicker" class="text-gray-400 hover:text-white text-2xl">&times;</button>
            </div>
            <input type="text" id="emojiSearchInput" class="w-full p-2 rounded-lg bg-gray-700 text-white border border-gray-600 mb-4" placeholder="Search icons..." data-i18n-placeholder="miniapp_target_creation_icon_picker_search">
            <div id="emojiCategories" class="flex flex-wrap gap-2 mb-4">
                <!-- Categories will be dynamically loaded -->
            </div>
            <div id="emojiList" class="grid grid-cols-8 gap-2 overflow-y-auto" style="max-height: 400px; overflow-y: auto;">
                <!-- Emojis will be dynamically loaded -->
            </div>
            <p id="noEmojiResults" class="text-gray-400 text-center mt-4 hidden" data-i18n="miniapp_target_creation_icon_picker_no_results">No results</p>
        </div>
    </div>

    <!-- æƒ…æŠ¥è§£å¯†åŠ è½½åŠ¨ç”»é®ç½©å±‚ -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <!-- æ‰«æå…‰æŸ -->
        <div class="scan-beam"></div>

        <!-- åå…­è¿›åˆ¶ä»£ç æµèƒŒæ™¯ -->
        <div class="hex-stream-container">
            <div class="hex-stream" id="hexStream1"></div>
            <div class="hex-stream" id="hexStream2"></div>
            <div class="hex-stream" id="hexStream3"></div>
        </div>

        <!-- ä¸­å¿ƒå†…å®¹ -->
        <div class="loading-content">
            <div class="decrypting-text" id="decryptingText">[ DECRYPTING_SIGNAL... ]</div>
            <div class="security-bypass" id="securityBypass">SECURITY_BYPASS: <span id="bypassPercent">0</span>%</div>
        </div>
    </div>

    <!-- æƒ…æŠ¥è§£å¯†å…¨å±é®ç½©å±‚ï¼ˆæ–°ç‰ˆæœ¬ï¼‰ -->
    <div id="decrypt-overlay" class="decrypt-overlay hidden">
        <!-- ç»¿è‰²æ¿€å…‰æ‰«æçº¿ -->
        <div class="decrypt-scan-line"></div>

        <!-- ä¸­å¿ƒå†…å®¹ -->
        <div class="decrypt-content">
            <!-- ä¿¡å·è·³åŠ¨ -->
            <div class="decrypt-signal" id="decryptSignal">[ SIGNAL_SEARCHING... ]</div>

            <!-- å­—ç¬¦æ··æ·†åŒºåŸŸ -->
            <div class="decrypt-scramble" id="decryptScramble">DECRYPTING...</div>

            <!-- è¿›åº¦æ•°æ® -->
            <div class="decrypt-progress" id="decryptProgress">SECURITY_BYPASS: <span id="decryptPercent">0</span>%</div>
        </div>
    </div>

    <!-- è‡ªå®šä¹‰è¾“å…¥å¼¹çª— -->
    <div id="customInputModal" class="custom-input-modal">
        <div class="custom-input-modal-content">
            <div class="custom-input-modal-title" id="customInputModalTitle">Enter Custom Value</div>
            <input type="text" id="customInputModalInput" class="custom-input-modal-input" placeholder="" maxlength="20">
            <div class="custom-input-modal-buttons">
                <button class="custom-input-modal-btn custom-input-modal-btn-cancel" id="customInputModalCancel">Cancel</button>
                <button class="custom-input-modal-btn custom-input-modal-btn-confirm" id="customInputModalConfirm">Confirm</button>
            </div>
        </div>
    </div>

    <script>
        // ==================== å¤šè¯­è¨€åŒ… (i18n) ====================
        // ä¸ main.py ä¸­çš„ LANG_MAPPING ä¿æŒå®Œå…¨ä¸€è‡´
        const translations = {
            "zh": {
                "page_title_config": "ğŸ¯ åšå¼ˆé…ç½®",
                "label_relationship": "å…³ç³»ç±»å‹",
                "label_stage": "åšå¼ˆé˜¶æ®µ",
                "relationship_lover": "æƒ…ä¾£",
                "relationship_ex": "å‰ä»»",
                "relationship_boss": "ä¸Šå¸",
                "relationship_colleague": "åŒäº‹",
                "stage_ambiguous": "æš§æ˜§",
                "stage_cold": "å†·æˆ˜",
                "stage_harvest": "æ”¶å‰²",
                "btn_start_analysis": "âš¡ å¼€å§‹åˆ†æ",
                "status_sending": "ğŸ“¡ æ­£åœ¨å‘é€é…ç½®...",
                "status_sent": "âœ… é…ç½®å·²å‘é€ï¼Œæ­£åœ¨å¯åŠ¨åˆ†æå¼•æ“...",
                "status_sent_alt": "âœ… é…ç½®å·²å‘é€ï¼è¯·è¿”å› Bot æŸ¥çœ‹åˆ†ææŠ¥å‘Šã€‚",
                "status_failed": "âŒ å‘é€å¤±è´¥ï¼Œè¯·é‡è¯•",
                "status_not_telegram": "âš ï¸ è¯·åœ¨ Telegram ä¸­ä½¿ç”¨æ­¤åŠŸèƒ½",
                "page_title_archives": "ğŸ“ ç›®æ ‡æ¡£æ¡ˆ",
                "page_desc_archives": "æŸ¥çœ‹å’Œç®¡ç†æ‚¨çš„åšå¼ˆç›®æ ‡æ¡£æ¡ˆ",
                "empty_archives": "æš‚æ— ç›®æ ‡æ¡£æ¡ˆ",
                "empty_archives_hint": "å¼€å§‹æ‚¨çš„ç¬¬ä¸€æ¬¡åšå¼ˆåˆ†æ",
                "page_title_energy": "âš¡ èƒ½é‡å¹³è¡¡ä»ª",
                "energy_available": "å½“å‰å¯ç”¨åˆ†ææ¬¡æ•°ï¼š",
                "energy_times": "æ¬¡",
                "page_title_invite": "ğŸ” åŠ å¯†é‚€è¯·ç ",
                "btn_copy": "å¤åˆ¶",
                "btn_copied": "å·²å¤åˆ¶",
                "invite_desc": "åˆ†äº«æ­¤é‚€è¯·ç ç»™å¥½å‹ï¼ŒåŒæ–¹å‡å¯è·å¾—èƒ½é‡å¥–åŠ±",
                "page_title_recharge": "ğŸ’ èƒ½é‡å……å€¼",
                "recharge_desc": "ä½¿ç”¨ Telegram Stars å……å€¼èƒ½é‡",
                "recharge_100": "100 Stars - è·å¾— 10 æ¬¡åˆ†æ",
                "recharge_500": "500 Stars - è·å¾— 60 æ¬¡åˆ†æ",
                "recharge_1000": "1000 Stars - è·å¾— 150 æ¬¡åˆ†æ",
                "status_recharge": "ğŸ’ æ­£åœ¨å¤„ç† {amount} Stars å……å€¼è¯·æ±‚...",
                "page_title_user": "ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯",
                "label_user_id": "ç”¨æˆ·ID",
                "label_register_time": "æ³¨å†Œæ—¶é—´",
                "nav_target": "åšå¼ˆ",
                "nav_folder": "æ¡£æ¡ˆ",
                "nav_user": "ä¸­å¿ƒ",
                "dominance_label": "ä¸»å¯¼æƒæŒ‡æ•°",
                "status_live": "LIVE",
                "status_archived": "ARCHIVED",
                "unknown_target": "æœªçŸ¥ç›®æ ‡",
                "unclassified": "æœªåˆ†ç±»",
                "not_set": "æœªè®¾ç½®",
                "btn_custom": "âœï¸ è‡ªå®šä¹‰",
                "custom_placeholder_relationship": "è¯·è¾“å…¥å…³ç³»ç±»å‹ï¼ˆå¦‚ï¼šçˆ¬å‹ã€ç½‘å‹ï¼‰",
                "custom_placeholder_stage": "è¯·è¾“å…¥åšå¼ˆé˜¶æ®µï¼ˆå¦‚ï¼šè¯•æ¢ã€æ‹‰æ‰¯ï¼‰",
                "status_custom_required": "âš ï¸ è¯·å®Œæˆè‡ªå®šä¹‰è¾“å…¥æˆ–é€‰æ‹©é¢„è®¾é€‰é¡¹",
                "target_creation_title": "âœ¨ æ¡£æ¡ˆåˆå§‹åŒ–",
                "target_creation_desc": "ä¸ºä½ çš„æ–°çŒç‰©å»ºç«‹æ¡£æ¡ˆï¼Œå¼€å¯åšå¼ˆã€‚",
                "target_name_placeholder": "ä¾‹å¦‚ï¼šå‰ä»»Aï¼Œè€æ¿ï¼Œé‚£ä¸ªç”·äºº...",
                "miniapp_target_name_label": "æ¡£æ¡ˆåç§°",
                "miniapp_target_icon_label": "æ¡£æ¡ˆå›¾æ ‡",
                "miniapp_target_name_error": "æ¡£æ¡ˆåç§°ä¸èƒ½ä¸ºç©ºï¼Œä¸”ä¸èƒ½è¶…è¿‡20ä¸ªå­—ç¬¦ã€‚",
                "miniapp_target_icon_error": "è¯·é€‰æ‹©ä¸€ä¸ªæœ‰æ•ˆçš„Emojiå›¾æ ‡ã€‚",
                "miniapp_target_creation_confirm": "ç¡®è®¤åˆ›å»º",
                "miniapp_target_creation_cancel": "å–æ¶ˆ",
                "miniapp_target_creation_select_icon_placeholder": "ç‚¹å‡»é€‰æ‹©å›¾æ ‡",
                "miniapp_target_creation_icon_picker_title": "é€‰æ‹©ä¸€ä¸ªå›¾æ ‡",
                "miniapp_target_creation_icon_picker_search": "æœç´¢å›¾æ ‡...",
                "miniapp_target_creation_icon_picker_no_results": "æ— ç»“æœ",
                "target_creation_cancelled": "âŒ æ¡£æ¡ˆåˆ›å»ºå·²å–æ¶ˆã€‚",
                "miniapp_target_created": "âœ… æ¡£æ¡ˆã€{alias} {icon}ã€‘å·²åˆ›å»ºã€‚è¯·è¿”å›Botç»§ç»­ã€‚",
                "miniapp_target_creation_failed": "âŒ æ¡£æ¡ˆåˆ›å»ºå¤±è´¥ï¼Œè¯·é‡è¯•ã€‚",
                "new_target_default_name": "æ–°ç›®æ ‡",
                "miniapp_target_creation_icon_picker_recent": "æœ€è¿‘ä½¿ç”¨",
                "miniapp_target_creation_icon_picker_people": "äººç‰©",
                "miniapp_target_creation_icon_picker_animals": "åŠ¨ç‰©",
                "miniapp_target_creation_icon_picker_objects": "ç‰©å“",
                "miniapp_target_creation_icon_picker_symbols": "ç¬¦å·",
                "miniapp_target_creation_icon_picker_food": "é£Ÿç‰©",
                "miniapp_target_creation_icon_picker_travel": "æ—…è¡Œ",
                "miniapp_target_creation_icon_picker_flags": "æ——å¸œ",
                "loading_decrypting_signal": "DECRYPTING_SIGNAL",
                "loading_security_bypass": "SECURITY_BYPASS",
                "decrypt_signal_searching": "SIGNAL_SEARCHING",
                "decrypt_decrypting": "DECRYPTING"
            },
            "en": {
                "page_title_config": "ğŸ¯ Game Configuration",
                "label_relationship": "Relationship Type",
                "label_stage": "Game Stage",
                "relationship_lover": "Lover",
                "relationship_ex": "Ex",
                "relationship_boss": "Boss",
                "relationship_colleague": "Colleague",
                "stage_ambiguous": "Ambiguous",
                "stage_cold": "Cold War",
                "stage_harvest": "Harvest",
                "btn_start_analysis": "âš¡ Start Analysis",
                "status_sending": "ğŸ“¡ Sending configuration...",
                "status_sent": "âœ… Configuration sent. Starting analysis engine...",
                "status_sent_alt": "âœ… Configuration sent! Please return to Bot to view the analysis report.",
                "status_failed": "âŒ Send failed, please try again",
                "status_not_telegram": "âš ï¸ Please use this feature in Telegram",
                "page_title_archives": "ğŸ“ Target Archives",
                "page_desc_archives": "View and manage your game target archives",
                "empty_archives": "No target archives",
                "empty_archives_hint": "Start your first game analysis",
                "page_title_energy": "âš¡ Energy Meter",
                "energy_available": "Available analyses:",
                "energy_times": "times",
                "page_title_invite": "ğŸ” Encrypted Invite Code",
                "btn_copy": "Copy",
                "btn_copied": "Copied",
                "invite_desc": "Share this invite code with friends, both parties will receive energy rewards",
                "page_title_recharge": "ğŸ’ Energy Recharge",
                "recharge_desc": "Recharge energy using Telegram Stars",
                "recharge_100": "100 Stars - Get 10 analyses",
                "recharge_500": "500 Stars - Get 60 analyses",
                "recharge_1000": "1000 Stars - Get 150 analyses",
                "status_recharge": "ğŸ’ Processing {amount} Stars recharge request...",
                "page_title_user": "ğŸ‘¤ User Info",
                "label_user_id": "User ID",
                "label_register_time": "Register Time",
                "nav_target": "Game",
                "nav_folder": "Archives",
                "nav_user": "Center",
                "dominance_label": "Dominance Index",
                "status_live": "LIVE",
                "status_archived": "ARCHIVED",
                "unknown_target": "Unknown Target",
                "unclassified": "Unclassified",
                "not_set": "Not Set",
                "btn_custom": "âœï¸ Custom",
                "custom_placeholder_relationship": "Enter relationship type (e.g., friend, online friend)",
                "custom_placeholder_stage": "Enter game stage (e.g., testing, pulling)",
                "status_custom_required": "âš ï¸ Please complete custom input or select a preset option",
                "target_creation_title": "âœ¨ Archive Initialization",
                "target_creation_desc": "Create an archive for your new prey to start the game.",
                "target_name_placeholder": "e.g., Ex-A, Boss, That Guy...",
                "miniapp_target_name_label": "Archive Name",
                "miniapp_target_icon_label": "Archive Icon",
                "miniapp_target_name_error": "Archive name cannot be empty and must not exceed 20 characters.",
                "miniapp_target_icon_error": "Please select a valid Emoji icon.",
                "miniapp_target_creation_confirm": "Confirm Create",
                "miniapp_target_creation_cancel": "Cancel",
                "miniapp_target_creation_select_icon_placeholder": "Click to select icon",
                "miniapp_target_creation_icon_picker_title": "Select an Icon",
                "miniapp_target_creation_icon_picker_search": "Search icons...",
                "miniapp_target_creation_icon_picker_no_results": "No results",
                "target_creation_cancelled": "âŒ Archive creation cancelled.",
                "miniapp_target_created": "âœ… Archive [{alias} {icon}] created. Please return to Bot to continue.",
                "miniapp_target_creation_failed": "âŒ Archive creation failed, please try again.",
                "new_target_default_name": "New Target",
                "miniapp_target_creation_icon_picker_recent": "Recently Used",
                "miniapp_target_creation_icon_picker_people": "People",
                "miniapp_target_creation_icon_picker_animals": "Animals",
                "miniapp_target_creation_icon_picker_objects": "Objects",
                "miniapp_target_creation_icon_picker_symbols": "Symbols",
                "miniapp_target_creation_icon_picker_food": "Food",
                "miniapp_target_creation_icon_picker_travel": "Travel",
                "miniapp_target_creation_icon_picker_flags": "Flags",
                "loading_decrypting_signal": "DECRYPTING_SIGNAL",
                "loading_security_bypass": "SECURITY_BYPASS",
                "decrypt_signal_searching": "SIGNAL_SEARCHING",
                "decrypt_decrypting": "DECRYPTING"
            },
            "ru": {
                "page_title_config": "ğŸ¯ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ğ¸Ğ³Ñ€Ñ‹",
                "label_relationship": "Ğ¢Ğ¸Ğ¿ Ğ¾Ñ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğ¹",
                "label_stage": "Ğ­Ñ‚Ğ°Ğ¿ Ğ¸Ğ³Ñ€Ñ‹",
                "relationship_lover": "Ğ›ÑĞ±Ğ¾Ğ²Ğ½Ğ¸Ğº",
                "relationship_ex": "Ğ‘Ñ‹Ğ²ÑˆĞ¸Ğ¹",
                "relationship_boss": "Ğ‘Ğ¾ÑÑ",
                "relationship_colleague": "ĞšĞ¾Ğ»Ğ»ĞµĞ³Ğ°",
                "stage_ambiguous": "ĞĞµĞ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ",
                "stage_cold": "Ğ¥Ğ¾Ğ»Ğ¾Ğ´Ğ½Ğ°Ñ Ğ²Ğ¾Ğ¹Ğ½Ğ°",
                "stage_harvest": "Ğ¡Ğ±Ğ¾Ñ€ ÑƒÑ€Ğ¾Ğ¶Ğ°Ñ",
                "btn_start_analysis": "âš¡ ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·",
                "status_sending": "ğŸ“¡ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸...",
                "status_sent": "âœ… ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ°. Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ´Ğ²Ğ¸Ğ¶ĞºĞ° Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°...",
                "status_sent_alt": "âœ… ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ°! ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ²ĞµÑ€Ğ½Ğ¸Ñ‚ĞµÑÑŒ Ğ² Bot Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€Ğ° Ğ¾Ñ‚Ñ‡ĞµÑ‚Ğ°.",
                "status_failed": "âŒ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ½Ğµ ÑƒĞ´Ğ°Ğ»Ğ°ÑÑŒ, Ğ¿Ğ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹Ñ‚Ğµ ÑĞ½Ğ¾Ğ²Ğ°",
                "status_not_telegram": "âš ï¸ ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ ÑÑ‚Ñƒ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ² Telegram",
                "page_title_archives": "ğŸ“ ĞÑ€Ñ…Ğ¸Ğ²Ñ‹ Ñ†ĞµĞ»ĞµĞ¹",
                "page_desc_archives": "ĞŸÑ€Ğ¾ÑĞ¼Ğ¾Ñ‚Ñ€ Ğ¸ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ°Ñ€Ñ…Ğ¸Ğ²Ğ°Ğ¼Ğ¸ Ñ†ĞµĞ»ĞµĞ¹ Ğ¸Ğ³Ñ€Ñ‹",
                "empty_archives": "ĞĞµÑ‚ Ğ°Ñ€Ñ…Ğ¸Ğ²Ğ¾Ğ² Ñ†ĞµĞ»ĞµĞ¹",
                "empty_archives_hint": "ĞĞ°Ñ‡Ğ½Ğ¸Ñ‚Ğµ ÑĞ²Ğ¾Ğ¹ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ¸Ğ³Ñ€Ñ‹",
                "page_title_energy": "âš¡ Ğ¡Ñ‡ĞµÑ‚Ñ‡Ğ¸Ğº ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸",
                "energy_available": "Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹Ğµ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ñ‹:",
                "energy_times": "Ñ€Ğ°Ğ·",
                "page_title_invite": "ğŸ” Ğ—Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ ĞºĞ¾Ğ´ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ñ",
                "btn_copy": "ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ",
                "btn_copied": "Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾",
                "invite_desc": "ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ĞµÑÑŒ ÑÑ‚Ğ¸Ğ¼ ĞºĞ¾Ğ´Ğ¾Ğ¼ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ñ Ñ Ğ´Ñ€ÑƒĞ·ÑŒÑĞ¼Ğ¸, Ğ¾Ğ±Ğµ ÑÑ‚Ğ¾Ñ€Ğ¾Ğ½Ñ‹ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ Ğ½Ğ°Ğ³Ñ€Ğ°Ğ´Ñ‹ ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸",
                "page_title_recharge": "ğŸ’ ĞŸĞ¾Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ ÑĞ½ĞµÑ€Ğ³Ğ¸Ğ¸",
                "recharge_desc": "ĞŸĞ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚Ğµ ÑĞ½ĞµÑ€Ğ³Ğ¸Ñ Ñ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰ÑŒÑ Telegram Stars",
                "recharge_100": "100 Stars - ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ 10 Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²",
                "recharge_500": "500 Stars - ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ 60 Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²",
                "recharge_1000": "1000 Stars - ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ 150 Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²",
                "status_recharge": "ğŸ’ ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ½Ğ° Ğ¿Ğ¾Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ {amount} Stars...",
                "page_title_user": "ğŸ‘¤ Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğµ",
                "label_user_id": "ID Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ",
                "label_register_time": "Ğ’Ñ€ĞµĞ¼Ñ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸",
                "nav_target": "Ğ˜Ğ³Ñ€Ğ°",
                "nav_folder": "ĞÑ€Ñ…Ğ¸Ğ²Ñ‹",
                "nav_user": "Ğ¦ĞµĞ½Ñ‚Ñ€",
                "dominance_label": "Ğ˜Ğ½Ğ´ĞµĞºÑ Ğ´Ğ¾Ğ¼Ğ¸Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ",
                "status_live": "ĞĞšĞ¢Ğ˜Ğ’ĞĞ",
                "status_archived": "ĞĞ Ğ¥Ğ˜Ğ’",
                "unknown_target": "ĞĞµĞ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ğ°Ñ Ñ†ĞµĞ»ÑŒ",
                "unclassified": "ĞĞµ ĞºĞ»Ğ°ÑÑĞ¸Ñ„Ğ¸Ñ†Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¾",
                "not_set": "ĞĞµ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾",
                "btn_custom": "âœï¸ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğ¹",
                "custom_placeholder_relationship": "Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ñ‚Ğ¸Ğ¿ Ğ¾Ñ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğ¹ (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, Ğ´Ñ€ÑƒĞ³, Ğ¾Ğ½Ğ»Ğ°Ğ¹Ğ½-Ğ´Ñ€ÑƒĞ³)",
                "custom_placeholder_stage": "Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ÑÑ‚Ğ°Ğ¿ Ğ¸Ğ³Ñ€Ñ‹ (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ, Ñ‚ÑĞ³Ğ°)",
                "status_custom_required": "âš ï¸ ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°, Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ñ‚Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğ¹ Ğ²Ğ²Ğ¾Ğ´ Ğ¸Ğ»Ğ¸ Ğ²Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ¿Ñ€ĞµĞ´ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚",
                "loading_decrypting_signal": "Ğ ĞĞ¡Ğ¨Ğ˜Ğ¤Ğ ĞĞ’ĞšĞ_Ğ¡Ğ˜Ğ“ĞĞĞ›Ğ",
                "loading_security_bypass": "ĞĞ‘Ğ¥ĞĞ”_Ğ‘Ğ•Ğ—ĞĞŸĞĞ¡ĞĞĞ¡Ğ¢Ğ˜",
                "decrypt_signal_searching": "ĞŸĞĞ˜Ğ¡Ğš_Ğ¡Ğ˜Ğ“ĞĞĞ›Ğ",
                "decrypt_decrypting": "Ğ ĞĞ¡Ğ¨Ğ˜Ğ¤Ğ ĞĞ’ĞšĞ"
            },
            "jp": {
                "page_title_config": "ğŸ¯ ã‚²ãƒ¼ãƒ è¨­å®š",
                "label_relationship": "é–¢ä¿‚ã‚¿ã‚¤ãƒ—",
                "label_stage": "ã‚²ãƒ¼ãƒ æ®µéš",
                "relationship_lover": "æ‹äºº",
                "relationship_ex": "å…ƒæ‹äºº",
                "relationship_boss": "ä¸Šå¸",
                "relationship_colleague": "åŒåƒš",
                "stage_ambiguous": "æ›–æ˜§",
                "stage_cold": "å†·æˆ¦",
                "stage_harvest": "åç©«",
                "btn_start_analysis": "âš¡ åˆ†æé–‹å§‹",
                "status_sending": "ğŸ“¡ è¨­å®šã‚’é€ä¿¡ä¸­...",
                "status_sent": "âœ… è¨­å®šãŒé€ä¿¡ã•ã‚Œã¾ã—ãŸã€‚åˆ†æã‚¨ãƒ³ã‚¸ãƒ³ã‚’èµ·å‹•ä¸­...",
                "status_sent_alt": "âœ… è¨­å®šãŒé€ä¿¡ã•ã‚Œã¾ã—ãŸï¼Botã«æˆ»ã£ã¦åˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚",
                "status_failed": "âŒ é€ä¿¡å¤±æ•—ã€å†è©¦è¡Œã—ã¦ãã ã•ã„",
                "status_not_telegram": "âš ï¸ Telegramã§ã“ã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„",
                "page_title_archives": "ğŸ“ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¢ãƒ¼ã‚«ã‚¤ãƒ–",
                "page_desc_archives": "ã‚²ãƒ¼ãƒ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã®è¡¨ç¤ºã¨ç®¡ç†",
                "empty_archives": "ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ãªã—",
                "empty_archives_hint": "æœ€åˆã®ã‚²ãƒ¼ãƒ åˆ†æã‚’é–‹å§‹",
                "page_title_energy": "âš¡ ã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆ",
                "energy_available": "åˆ©ç”¨å¯èƒ½ãªåˆ†æå›æ•°ï¼š",
                "energy_times": "å›",
                "page_title_invite": "ğŸ” æš—å·åŒ–ã•ã‚ŒãŸæ‹›å¾…ã‚³ãƒ¼ãƒ‰",
                "btn_copy": "ã‚³ãƒ”ãƒ¼",
                "btn_copied": "ã‚³ãƒ”ãƒ¼æ¸ˆã¿",
                "invite_desc": "ã“ã®æ‹›å¾…ã‚³ãƒ¼ãƒ‰ã‚’å‹é”ã¨å…±æœ‰ã™ã‚‹ã¨ã€ä¸¡æ–¹ã®å½“äº‹è€…ãŒã‚¨ãƒãƒ«ã‚®ãƒ¼å ±é…¬ã‚’å—ã‘å–ã‚Šã¾ã™",
                "page_title_recharge": "ğŸ’ ã‚¨ãƒãƒ«ã‚®ãƒ¼å……é›»",
                "recharge_desc": "Telegram Starsã‚’ä½¿ç”¨ã—ã¦ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å……é›»",
                "recharge_100": "100 Stars - 10å›ã®åˆ†æã‚’ç²å¾—",
                "recharge_500": "500 Stars - 60å›ã®åˆ†æã‚’ç²å¾—",
                "recharge_1000": "1000 Stars - 150å›ã®åˆ†æã‚’ç²å¾—",
                "status_recharge": "ğŸ’ {amount} Starså……é›»ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ä¸­...",
                "page_title_user": "ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±",
                "label_user_id": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ID",
                "label_register_time": "ç™»éŒ²æ™‚é–“",
                "nav_target": "ã‚²ãƒ¼ãƒ ",
                "nav_folder": "ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–",
                "nav_user": "ã‚»ãƒ³ã‚¿ãƒ¼",
                "dominance_label": "æ”¯é…æŒ‡æ•°",
                "status_live": "ãƒ©ã‚¤ãƒ–",
                "status_archived": "ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ¸ˆã¿",
                "unknown_target": "æœªçŸ¥ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ",
                "unclassified": "æœªåˆ†é¡",
                "not_set": "æœªè¨­å®š",
                "btn_custom": "âœï¸ ã‚«ã‚¹ã‚¿ãƒ ",
                "custom_placeholder_relationship": "é–¢ä¿‚ã‚¿ã‚¤ãƒ—ã‚’å…¥åŠ›ï¼ˆä¾‹ï¼šå‹é”ã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ•ãƒ¬ãƒ³ãƒ‰ï¼‰",
                "custom_placeholder_stage": "ã‚²ãƒ¼ãƒ æ®µéšã‚’å…¥åŠ›ï¼ˆä¾‹ï¼šè©¦è¡Œã€å¼•ã£å¼µã‚Šï¼‰",
                "status_custom_required": "âš ï¸ ã‚«ã‚¹ã‚¿ãƒ å…¥åŠ›ã‚’å®Œäº†ã™ã‚‹ã‹ã€ãƒ—ãƒªã‚»ãƒƒãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’é¸æŠã—ã¦ãã ã•ã„",
                "loading_decrypting_signal": "å¾©å·åŒ–ã‚·ã‚°ãƒŠãƒ«",
                "loading_security_bypass": "ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚¤ãƒ‘ã‚¹",
                "decrypt_signal_searching": "ã‚·ã‚°ãƒŠãƒ«æ¤œç´¢ä¸­",
                "decrypt_decrypting": "å¾©å·åŒ–ä¸­"
            },
            "de": {
                "page_title_config": "ğŸ¯ Spielkonfiguration",
                "label_relationship": "Beziehungstyp",
                "label_stage": "Spielphase",
                "relationship_lover": "Liebhaber",
                "relationship_ex": "Ex",
                "relationship_boss": "Chef",
                "relationship_colleague": "Kollege",
                "stage_ambiguous": "Mehrdeutig",
                "stage_cold": "Kalter Krieg",
                "stage_harvest": "Ernte",
                "btn_start_analysis": "âš¡ Analyse starten",
                "status_sending": "ğŸ“¡ Konfiguration wird gesendet...",
                "status_sent": "âœ… Konfiguration gesendet. Starte Analyse-Engine...",
                "status_sent_alt": "âœ… Konfiguration gesendet! Bitte kehren Sie zum Bot zurÃ¼ck, um den Analysebericht anzuzeigen.",
                "status_failed": "âŒ Senden fehlgeschlagen, bitte erneut versuchen",
                "status_not_telegram": "âš ï¸ Bitte verwenden Sie diese Funktion in Telegram",
                "page_title_archives": "ğŸ“ Zielarchive",
                "page_desc_archives": "Zielarchive des Spiels anzeigen und verwalten",
                "empty_archives": "Keine Zielarchive",
                "empty_archives_hint": "Starten Sie Ihre erste Spielanalyse",
                "page_title_energy": "âš¡ Energiemesser",
                "energy_available": "VerfÃ¼gbare Analysen:",
                "energy_times": "Mal",
                "page_title_invite": "ğŸ” VerschlÃ¼sselter Einladungscode",
                "btn_copy": "Kopieren",
                "btn_copied": "Kopiert",
                "invite_desc": "Teilen Sie diesen Einladungscode mit Freunden, beide Parteien erhalten Energiebelohnungen",
                "page_title_recharge": "ğŸ’ Energie aufladen",
                "recharge_desc": "Energie mit Telegram Stars aufladen",
                "recharge_100": "100 Stars - 10 Analysen erhalten",
                "recharge_500": "500 Stars - 60 Analysen erhalten",
                "recharge_1000": "1000 Stars - 150 Analysen erhalten",
                "status_recharge": "ğŸ’ Verarbeite {amount} Stars Aufladungsanfrage...",
                "page_title_user": "ğŸ‘¤ Benutzerinformationen",
                "label_user_id": "Benutzer-ID",
                "label_register_time": "Registrierungszeit",
                "nav_target": "Spiel",
                "nav_folder": "Archive",
                "nav_user": "Zentrum",
                "dominance_label": "Dominanzindex",
                "status_live": "LIVE",
                "status_archived": "ARCHIVIERT",
                "unknown_target": "Unbekanntes Ziel",
                "unclassified": "Nicht klassifiziert",
                "not_set": "Nicht gesetzt",
                "btn_custom": "âœï¸ Benutzerdefiniert",
                "custom_placeholder_relationship": "Beziehungstyp eingeben (z.B. Freund, Online-Freund)",
                "custom_placeholder_stage": "Spielphase eingeben (z.B. Testen, Ziehen)",
                "status_custom_required": "âš ï¸ Bitte vervollstÃ¤ndigen Sie die benutzerdefinierte Eingabe oder wÃ¤hlen Sie eine Voreinstellung",
                "loading_decrypting_signal": "ENTSCHLÃœSSELUNG_SIGNAL",
                "loading_security_bypass": "SICHERHEITSUMGANG",
                "decrypt_signal_searching": "SIGNAL_SUCHE",
                "decrypt_decrypting": "ENTSCHLÃœSSELUNG"
            },
            "fr": {
                "page_title_config": "ğŸ¯ Configuration du jeu",
                "label_relationship": "Type de relation",
                "label_stage": "Ã‰tape du jeu",
                "relationship_lover": "Amant",
                "relationship_ex": "Ex",
                "relationship_boss": "Patron",
                "relationship_colleague": "CollÃ¨gue",
                "stage_ambiguous": "Ambigu",
                "stage_cold": "Guerre froide",
                "stage_harvest": "RÃ©colte",
                "btn_start_analysis": "âš¡ DÃ©marrer l'analyse",
                "status_sending": "ğŸ“¡ Envoi de la configuration...",
                "status_sent": "âœ… Configuration envoyÃ©e. DÃ©marrage du moteur d'analyse...",
                "status_sent_alt": "âœ… Configuration envoyÃ©e! Veuillez retourner au Bot pour voir le rapport d'analyse.",
                "status_failed": "âŒ Ã‰chec de l'envoi, veuillez rÃ©essayer",
                "status_not_telegram": "âš ï¸ Veuillez utiliser cette fonctionnalitÃ© dans Telegram",
                "page_title_archives": "ğŸ“ Archives des cibles",
                "page_desc_archives": "Afficher et gÃ©rer vos archives de cibles de jeu",
                "empty_archives": "Aucune archive de cible",
                "empty_archives_hint": "Commencez votre premiÃ¨re analyse de jeu",
                "page_title_energy": "âš¡ Compteur d'Ã©nergie",
                "energy_available": "Analyses disponibles:",
                "energy_times": "fois",
                "page_title_invite": "ğŸ” Code d'invitation cryptÃ©",
                "btn_copy": "Copier",
                "btn_copied": "CopiÃ©",
                "invite_desc": "Partagez ce code d'invitation avec des amis, les deux parties recevront des rÃ©compenses d'Ã©nergie",
                "page_title_recharge": "ğŸ’ Rechargement d'Ã©nergie",
                "recharge_desc": "Recharger l'Ã©nergie avec Telegram Stars",
                "recharge_100": "100 Stars - Obtenir 10 analyses",
                "recharge_500": "500 Stars - Obtenir 60 analyses",
                "recharge_1000": "1000 Stars - Obtenir 150 analyses",
                "status_recharge": "ğŸ’ Traitement de la demande de recharge de {amount} Stars...",
                "page_title_user": "ğŸ‘¤ Informations utilisateur",
                "label_user_id": "ID utilisateur",
                "label_register_time": "Heure d'inscription",
                "nav_target": "Jeu",
                "nav_folder": "Archives",
                "nav_user": "Centre",
                "dominance_label": "Indice de domination",
                "status_live": "EN DIRECT",
                "status_archived": "ARCHIVÃ‰",
                "unknown_target": "Cible inconnue",
                "unclassified": "Non classÃ©",
                "not_set": "Non dÃ©fini",
                "btn_custom": "âœï¸ PersonnalisÃ©",
                "custom_placeholder_relationship": "Entrez le type de relation (ex: ami, ami en ligne)",
                "custom_placeholder_stage": "Entrez l'Ã©tape du jeu (ex: test, traction)",
                "status_custom_required": "âš ï¸ Veuillez complÃ©ter la saisie personnalisÃ©e ou sÃ©lectionner une option prÃ©dÃ©finie",
                "loading_decrypting_signal": "DÃ‰CHIFFREMENT_SIGNAL",
                "loading_security_bypass": "CONTOURNEMENT_SÃ‰CURITÃ‰",
                "decrypt_signal_searching": "RECHERCHE_SIGNAL",
                "decrypt_decrypting": "DÃ‰CHIFFREMENT"
            },
            "es": {
                "page_title_config": "ğŸ¯ ConfiguraciÃ³n del juego",
                "label_relationship": "Tipo de relaciÃ³n",
                "label_stage": "Etapa del juego",
                "relationship_lover": "Amante",
                "relationship_ex": "Ex",
                "relationship_boss": "Jefe",
                "relationship_colleague": "Colega",
                "stage_ambiguous": "Ambiguo",
                "stage_cold": "Guerra frÃ­a",
                "stage_harvest": "Cosecha",
                "btn_start_analysis": "âš¡ Iniciar anÃ¡lisis",
                "status_sending": "ğŸ“¡ Enviando configuraciÃ³n...",
                "status_sent": "âœ… ConfiguraciÃ³n enviada. Iniciando motor de anÃ¡lisis...",
                "status_sent_alt": "âœ… Â¡ConfiguraciÃ³n enviada! Por favor, regrese al Bot para ver el informe de anÃ¡lisis.",
                "status_failed": "âŒ EnvÃ­o fallido, por favor intente de nuevo",
                "status_not_telegram": "âš ï¸ Por favor use esta funciÃ³n en Telegram",
                "page_title_archives": "ğŸ“ Archivos de objetivos",
                "page_desc_archives": "Ver y gestionar sus archivos de objetivos del juego",
                "empty_archives": "No hay archivos de objetivos",
                "empty_archives_hint": "Comience su primer anÃ¡lisis del juego",
                "page_title_energy": "âš¡ Medidor de energÃ­a",
                "energy_available": "AnÃ¡lisis disponibles:",
                "energy_times": "veces",
                "page_title_invite": "ğŸ” CÃ³digo de invitaciÃ³n encriptado",
                "btn_copy": "Copiar",
                "btn_copied": "Copiado",
                "invite_desc": "Comparta este cÃ³digo de invitaciÃ³n con amigos, ambas partes recibirÃ¡n recompensas de energÃ­a",
                "page_title_recharge": "ğŸ’ Recarga de energÃ­a",
                "recharge_desc": "Recargar energÃ­a usando Telegram Stars",
                "recharge_100": "100 Stars - Obtener 10 anÃ¡lisis",
                "recharge_500": "500 Stars - Obtener 60 anÃ¡lisis",
                "recharge_1000": "1000 Stars - Obtener 150 anÃ¡lisis",
                "status_recharge": "ğŸ’ Procesando solicitud de recarga de {amount} Stars...",
                "page_title_user": "ğŸ‘¤ InformaciÃ³n del usuario",
                "label_user_id": "ID de usuario",
                "label_register_time": "Hora de registro",
                "nav_target": "Juego",
                "nav_folder": "Archivos",
                "nav_user": "Centro",
                "dominance_label": "Ãndice de dominancia",
                "status_live": "EN VIVO",
                "status_archived": "ARCHIVADO",
                "unknown_target": "Objetivo desconocido",
                "unclassified": "No clasificado",
                "not_set": "No establecido",
                "btn_custom": "âœï¸ Personalizado",
                "custom_placeholder_relationship": "Ingrese tipo de relaciÃ³n (ej: amigo, amigo en lÃ­nea)",
                "custom_placeholder_stage": "Ingrese etapa del juego (ej: prueba, tirÃ³n)",
                "status_custom_required": "âš ï¸ Por favor complete la entrada personalizada o seleccione una opciÃ³n preestablecida",
                "loading_decrypting_signal": "DESCIFRADO_SEÃ‘AL",
                "loading_security_bypass": "OMISIÃ“N_SEGURIDAD",
                "decrypt_signal_searching": "BÃšSQUEDA_SEÃ‘AL",
                "decrypt_decrypting": "DESCIFRANDO"
            },
            "ko": {
                "page_title_config": "ğŸ¯ ê²Œì„ ì„¤ì •",
                "label_relationship": "ê´€ê³„ ìœ í˜•",
                "label_stage": "ê²Œì„ ë‹¨ê³„",
                "relationship_lover": "ì—°ì¸",
                "relationship_ex": "ì „ ì—°ì¸",
                "relationship_boss": "ìƒì‚¬",
                "relationship_colleague": "ë™ë£Œ",
                "stage_ambiguous": "ì• ë§¤í•¨",
                "stage_cold": "ëƒ‰ì „",
                "stage_harvest": "ìˆ˜í™•",
                "btn_start_analysis": "âš¡ ë¶„ì„ ì‹œì‘",
                "status_sending": "ğŸ“¡ ì„¤ì • ì „ì†¡ ì¤‘...",
                "status_sent": "âœ… ì„¤ì •ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤. ë¶„ì„ ì—”ì§„ ì‹œì‘ ì¤‘...",
                "status_sent_alt": "âœ… ì„¤ì •ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤! Botìœ¼ë¡œ ëŒì•„ê°€ì„œ ë¶„ì„ ë³´ê³ ì„œë¥¼ í™•ì¸í•˜ì„¸ìš”.",
                "status_failed": "âŒ ì „ì†¡ ì‹¤íŒ¨, ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”",
                "status_not_telegram": "âš ï¸ Telegramì—ì„œ ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì„¸ìš”",
                "page_title_archives": "ğŸ“ íƒ€ê²Ÿ ì•„ì¹´ì´ë¸Œ",
                "page_desc_archives": "ê²Œì„ íƒ€ê²Ÿ ì•„ì¹´ì´ë¸Œ ë³´ê¸° ë° ê´€ë¦¬",
                "empty_archives": "íƒ€ê²Ÿ ì•„ì¹´ì´ë¸Œ ì—†ìŒ",
                "empty_archives_hint": "ì²« ë²ˆì§¸ ê²Œì„ ë¶„ì„ ì‹œì‘",
                "page_title_energy": "âš¡ ì—ë„ˆì§€ ë¯¸í„°",
                "energy_available": "ì‚¬ìš© ê°€ëŠ¥í•œ ë¶„ì„:",
                "energy_times": "íšŒ",
                "page_title_invite": "ğŸ” ì•”í˜¸í™”ëœ ì´ˆëŒ€ ì½”ë“œ",
                "btn_copy": "ë³µì‚¬",
                "btn_copied": "ë³µì‚¬ë¨",
                "invite_desc": "ì´ ì´ˆëŒ€ ì½”ë“œë¥¼ ì¹œêµ¬ì™€ ê³µìœ í•˜ë©´ ì–‘ìª½ ëª¨ë‘ ì—ë„ˆì§€ ë³´ìƒì„ ë°›ìŠµë‹ˆë‹¤",
                "page_title_recharge": "ğŸ’ ì—ë„ˆì§€ ì¶©ì „",
                "recharge_desc": "Telegram Starsë¥¼ ì‚¬ìš©í•˜ì—¬ ì—ë„ˆì§€ ì¶©ì „",
                "recharge_100": "100 Stars - 10íšŒ ë¶„ì„ íšë“",
                "recharge_500": "500 Stars - 60íšŒ ë¶„ì„ íšë“",
                "recharge_1000": "1000 Stars - 150íšŒ ë¶„ì„ íšë“",
                "status_recharge": "ğŸ’ {amount} Stars ì¶©ì „ ìš”ì²­ ì²˜ë¦¬ ì¤‘...",
                "page_title_user": "ğŸ‘¤ ì‚¬ìš©ì ì •ë³´",
                "label_user_id": "ì‚¬ìš©ì ID",
                "label_register_time": "ë“±ë¡ ì‹œê°„",
                "nav_target": "ê²Œì„",
                "nav_folder": "ì•„ì¹´ì´ë¸Œ",
                "nav_user": "ì„¼í„°",
                "dominance_label": "ì§€ë°° ì§€ìˆ˜",
                "status_live": "ë¼ì´ë¸Œ",
                "status_archived": "ì•„ì¹´ì´ë¸Œë¨",
                "unknown_target": "ì•Œ ìˆ˜ ì—†ëŠ” íƒ€ê²Ÿ",
                "unclassified": "ë¯¸ë¶„ë¥˜",
                "not_set": "ì„¤ì • ì•ˆ ë¨",
                "btn_custom": "âœï¸ ì‚¬ìš©ì ì •ì˜",
                "custom_placeholder_relationship": "ê´€ê³„ ìœ í˜• ì…ë ¥ (ì˜ˆ: ì¹œêµ¬, ì˜¨ë¼ì¸ ì¹œêµ¬)",
                "custom_placeholder_stage": "ê²Œì„ ë‹¨ê³„ ì…ë ¥ (ì˜ˆ: í…ŒìŠ¤íŠ¸, ë‹¹ê¸°ê¸°)",
                "status_custom_required": "âš ï¸ ì‚¬ìš©ì ì •ì˜ ì…ë ¥ì„ ì™„ë£Œí•˜ê±°ë‚˜ ì‚¬ì „ ì„¤ì • ì˜µì…˜ì„ ì„ íƒí•˜ì„¸ìš”",
                "loading_decrypting_signal": "ë³µí˜¸í™”_ì‹ í˜¸",
                "loading_security_bypass": "ë³´ì•ˆ_ìš°íšŒ",
                "decrypt_signal_searching": "ì‹ í˜¸_ê²€ìƒ‰ì¤‘",
                "decrypt_decrypting": "ë³µí˜¸í™”ì¤‘"
            }
        };

        // è¯­è¨€ä»£ç æ˜ å°„ï¼ˆTelegram language_code -> æˆ‘ä»¬çš„è¯­è¨€ä»£ç ï¼‰
        const langCodeMap = {
            "zh": "zh", "zh-CN": "zh", "zh-TW": "zh", "zh-HK": "zh",
            "en": "en", "en-US": "en", "en-GB": "en",
            "ru": "ru", "ru-RU": "ru",
            "es": "es", "es-ES": "es", "es-MX": "es",
            "ja": "jp", "jp": "jp",
            "de": "de", "de-DE": "de", "de-AT": "de", "de-CH": "de",
            "fr": "fr", "fr-FR": "fr", "fr-CA": "fr",
            "ko": "ko", "ko-KR": "ko"
        };

        // æ ‡å‡†åŒ–è¯­è¨€ä»£ç 
        function normalizeLangCode(langCode) {
            if (!langCode) return "en";
            langCode = langCode.toLowerCase();
            if ("-" in langCode) {
                const baseLang = langCode.split("-")[0];
                if (baseLang in langCodeMap) return langCodeMap[baseLang];
            }
            return langCodeMap[langCode] || "en";
        }

        // æ£€æµ‹è¯­è¨€
        function detectLanguage() {
            // 1. å°è¯•ä» URL å‚æ•°è·å–
            const urlParams = new URLSearchParams(window.location.search);
            const urlLang = urlParams.get('lang');
            if (urlLang) {
                const normalized = normalizeLangCode(urlLang);
                if (normalized in translations) {
                    console.log(`ğŸŒ Language detected from URL: ${normalized}`);
                    return normalized;
                }
            }

            // 2. å°è¯•ä» Telegram WebApp è·å–
            if (typeof window !== 'undefined' && window.Telegram && window.Telegram.WebApp) {
                const tg = window.Telegram.WebApp;
                if (tg.initDataUnsafe && tg.initDataUnsafe.user && tg.initDataUnsafe.user.language_code) {
                    const tgLang = normalizeLangCode(tg.initDataUnsafe.user.language_code);
                    if (tgLang in translations) {
                        console.log(`ğŸŒ Language detected from Telegram: ${tgLang}`);
                        return tgLang;
                    }
                }
            }

            // 3. é»˜è®¤è‹±è¯­
            console.log(`ğŸŒ Language defaulted to: en`);
            return "en";
        }

        // å½“å‰è¯­è¨€
        let currentLang = detectLanguage();

        // è·å–ç¿»è¯‘æ–‡æœ¬
        function t(key, params = {}) {
            const lang = currentLang in translations ? currentLang : "en";
            let text = translations[lang][key] || translations["en"][key] || key;

            // æ›¿æ¢å‚æ•°
            if (Object.keys(params).length > 0) {
                Object.keys(params).forEach(param => {
                    text = text.replace(`{${param}}`, params[param]);
                });
            }

            return text;
        }

        // åˆå§‹åŒ– i18nï¼ˆåœ¨ DOM åŠ è½½å®Œæˆåæ‰§è¡Œï¼‰
        function initI18n() {
            // ä¸ºæ‰€æœ‰éœ€è¦ç¿»è¯‘çš„å…ƒç´ æ·»åŠ  data-i18n å±æ€§å¹¶å¡«å……æ–‡æœ¬
            const elements = document.querySelectorAll('[data-i18n]');
            elements.forEach(el => {
                const key = el.getAttribute('data-i18n');
                const text = t(key);
                if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                    el.placeholder = text;
                } else {
                    el.textContent = text;
                }
            });
            // æ›´æ–°è‡ªå®šä¹‰è¾“å…¥æ¡†å ä½ç¬¦
            updateCustomPlaceholders();
        }

        // æ£€æŸ¥ Telegram WebApp æ˜¯å¦å¯ç”¨
        const isTelegramWebApp = typeof window !== 'undefined' && 
                                  window.Telegram && 
                                  window.Telegram.WebApp;

        // Telegram WebApp åˆå§‹åŒ–ï¼ˆå¸¦å®‰å…¨æ£€æŸ¥ï¼‰
        const tg = isTelegramWebApp ? window.Telegram.WebApp : null;

        if (tg) {
            // ready() å·²ç»åœ¨ head ä¸­è°ƒç”¨ï¼Œè¿™é‡Œåªåšæ‰©å±•å’Œä¸»é¢˜è®¾ç½®
            tg.expand();

            // è®¾ç½®ä¸»é¢˜
            tg.setHeaderColor('#000000');
            tg.setBackgroundColor('#000000');

            // å¯ç”¨å…³é—­ç¡®è®¤ï¼ˆå¯é€‰ï¼‰
            tg.enableClosingConfirmation();

            console.log('âœ“ Telegram WebApp expanded and configured');
        } else {
            console.warn('Telegram WebApp ä¸å¯ç”¨ï¼Œè¿è¡Œåœ¨é Telegram ç¯å¢ƒä¸­');
        }

        // å®‰å…¨çš„è§¦æ„Ÿåé¦ˆå‡½æ•°
        const hapticFeedback = {
            // ä¸­ç­‰å¼ºåº¦è§¦æ„Ÿåé¦ˆï¼ˆç”¨äºä¸»è¦æŒ‰é’®å’Œåˆ‡æ¢ï¼‰
            impact: (style = 'medium') => {
                if (tg && tg.HapticFeedback && tg.HapticFeedback.impactOccurred) {
                    try {
                        tg.HapticFeedback.impactOccurred(style);
                    } catch (e) {
                        console.warn('è§¦æ„Ÿåé¦ˆå¤±è´¥:', e);
                    }
                }
            },
            // é€šçŸ¥è§¦æ„Ÿåé¦ˆï¼ˆç”¨äºæˆåŠŸæ“ä½œï¼‰
            notification: (type = 'success') => {
                if (tg && tg.HapticFeedback && tg.HapticFeedback.notificationOccurred) {
                    try {
                        tg.HapticFeedback.notificationOccurred(type);
                    } catch (e) {
                        console.warn('é€šçŸ¥è§¦æ„Ÿåé¦ˆå¤±è´¥:', e);
                    }
                }
            }
        };

        // è·å– initDataï¼ˆå¸¦å®‰å…¨æ£€æŸ¥ï¼‰
        const initData = tg ? tg.initData : null;
        const initDataUnsafe = tg ? tg.initDataUnsafe : null;

        console.log('Telegram WebApp initData:', initData);
        console.log('Telegram WebApp initDataUnsafe:', initDataUnsafe);

        // é¡µé¢åˆ‡æ¢
        const pages = document.querySelectorAll('.page');
        const navItems = document.querySelectorAll('.nav-item');

        navItems.forEach(item => {
            item.addEventListener('click', () => {
                const targetPage = item.dataset.page;

                // è§¦æ„Ÿåé¦ˆ
                hapticFeedback.impact('medium');

                // æ›´æ–°å¯¼èˆªçŠ¶æ€
                navItems.forEach(nav => nav.classList.remove('active'));
                item.classList.add('active');

                // åˆ‡æ¢é¡µé¢ï¼ˆå¸¦æ·¡å…¥åŠ¨ç”»ï¼‰
                pages.forEach(page => {
                    page.classList.remove('active');
                    // é‡ç½®åŠ¨ç”»çŠ¶æ€
                    page.style.opacity = '0';
                    page.style.transform = 'translateY(20px)';
                });

                const targetPageElement = document.getElementById(`page-${targetPage}`);
                // ä½¿ç”¨ requestAnimationFrame ç¡®ä¿åŠ¨ç”»è§¦å‘
                requestAnimationFrame(() => {
                    targetPageElement.classList.add('active');
                    targetPageElement.style.opacity = '1';
                    targetPageElement.style.transform = 'translateY(0)';
                });
            });
        });

        // åˆ†æ®µé€‰æ‹©å™¨
        const segmentOptions = document.querySelectorAll('.segment-option');
        const config = {
            relationship: 'lover',
            stage: 'ambiguous'
        };

        // è‡ªå®šä¹‰è¾“å…¥å¼¹çª—å…ƒç´ 
        const customInputModal = document.getElementById('customInputModal');
        const customInputModalTitle = document.getElementById('customInputModalTitle');
        const customInputModalInput = document.getElementById('customInputModalInput');
        const customInputModalCancel = document.getElementById('customInputModalCancel');
        const customInputModalConfirm = document.getElementById('customInputModalConfirm');

        // å½“å‰æ­£åœ¨ç¼–è¾‘çš„è‡ªå®šä¹‰æŒ‰é’®
        let currentCustomButton = null;
        let currentCustomType = null;

        // æ˜¾ç¤ºè‡ªå®šä¹‰è¾“å…¥å¼¹çª—
        function showCustomInputModal(type, placeholder) {
            currentCustomType = type;
            customInputModalTitle.textContent = type === 'relationship' 
                ? t('custom_placeholder_relationship') 
                : t('custom_placeholder_stage');
            customInputModalInput.placeholder = placeholder;
            customInputModalInput.value = '';
            customInputModal.classList.add('show');
            setTimeout(() => {
                customInputModalInput.focus();
            }, 100);
        }

        // éšè—è‡ªå®šä¹‰è¾“å…¥å¼¹çª—
        function hideCustomInputModal() {
            customInputModal.classList.remove('show');
            currentCustomButton = null;
            currentCustomType = null;
        }

        // ç¡®è®¤è‡ªå®šä¹‰è¾“å…¥
        customInputModalConfirm.addEventListener('click', () => {
            const value = customInputModalInput.value.trim();
            if (!value) {
                return;
            }

            if (currentCustomButton && currentCustomType) {
                // æ›´æ–°æŒ‰é’®æ–‡å­—
                currentCustomButton.textContent = value;

                // è®¾ä¸ºé€‰ä¸­çŠ¶æ€
                document.querySelectorAll(`[data-type="${currentCustomType}"]`).forEach(opt => {
                    opt.classList.remove('active');
                });
                currentCustomButton.classList.add('active');

                // æ›´æ–°é…ç½®
                config[currentCustomType] = `custom:${value}`;

                // è§¦æ„Ÿåé¦ˆ
                hapticFeedback.notification('success');
            }

            hideCustomInputModal();
        });

        // å–æ¶ˆè‡ªå®šä¹‰è¾“å…¥
        customInputModalCancel.addEventListener('click', () => {
            hideCustomInputModal();
            hapticFeedback.impact('light');
        });

        // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
        customInputModal.addEventListener('click', (e) => {
            if (e.target === customInputModal) {
                hideCustomInputModal();
            }
        });

        // å›è½¦ç¡®è®¤
        customInputModalInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                customInputModalConfirm.click();
            }
        });

        // å¤„ç†åˆ†æ®µé€‰æ‹©å™¨ç‚¹å‡»ï¼ˆåŒæ—¶æ”¯æŒ click å’Œ touchstartï¼‰
        function handleSegmentOptionClick(option) {
            const type = option.dataset.type;
            const value = option.dataset.value;
            const buttonId = option.id;

            // è§¦æ„Ÿåé¦ˆ
            hapticFeedback.impact('medium');

            // å¤„ç†è‡ªå®šä¹‰æŒ‰é’®
            if (buttonId === 'rel-custom-btn' || buttonId === 'stage-custom-btn') {
                currentCustomButton = option;
                const placeholder = type === 'relationship' 
                    ? t('custom_placeholder_relationship')
                    : t('custom_placeholder_stage');
                showCustomInputModal(type, placeholder);
                return;
            }

            // å¤„ç†é¢„è®¾é€‰é¡¹
            // æ›´æ–°UI
            document.querySelectorAll(`[data-type="${type}"]`).forEach(opt => {
                opt.classList.remove('active');
            });
            option.classList.add('active');

            // æ›´æ–°é…ç½®
            config[type] = value;

            console.log(`âœ“ é€‰æ‹©äº† ${type}: ${value}`);
        }

        // ç»‘å®šäº‹ä»¶ï¼ˆåŒæ—¶æ”¯æŒ click å’Œ touchstartï¼Œç¡®ä¿ç§»åŠ¨ç«¯å¯ç”¨ï¼‰
        segmentOptions.forEach(option => {
            // ä½¿ç”¨ touchstart å’Œ click åŒé‡ç»‘å®šï¼Œç¡®ä¿ç§»åŠ¨ç«¯å¯ç”¨
            option.addEventListener('touchstart', (e) => {
                e.preventDefault(); // é˜²æ­¢åŒå‡»ç¼©æ”¾
                e.stopPropagation(); // é˜»æ­¢äº‹ä»¶å†’æ³¡
                handleSegmentOptionClick(option);
            }, { passive: false });

            option.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                handleSegmentOptionClick(option);
            });

            // æ·»åŠ è°ƒè¯•æ—¥å¿—
            option.addEventListener('touchstart', () => {
                console.log('ğŸ” Touch event detected on:', option.textContent);
            }, { passive: true });
        });

        // ç¡®è®¤é…ç½®æŒ‰é’®ï¼ˆå¼€å§‹åˆ†æï¼‰
        const confirmBtn = document.getElementById('confirmBtn');
        const statusCard = document.getElementById('statusCard');
        const statusText = document.getElementById('statusText');

        confirmBtn.addEventListener('click', () => {
            // è§¦æ„Ÿåé¦ˆ
            hapticFeedback.impact('medium');

            // ç¦ç”¨æŒ‰é’®ï¼Œé˜²æ­¢é‡å¤ç‚¹å‡»
            confirmBtn.disabled = true;
            confirmBtn.style.opacity = '0.6';
            confirmBtn.style.cursor = 'not-allowed';

            // éªŒè¯è‡ªå®šä¹‰è¾“å…¥
            if (config.relationship === null || config.stage === null) {
                statusCard.style.display = 'block';
                statusText.textContent = t('status_custom_required');
                statusText.className = 'text-sm text-amber-400';
                confirmBtn.disabled = false;
                confirmBtn.style.opacity = '1';
                confirmBtn.style.cursor = 'pointer';
                setTimeout(() => {
                    statusCard.style.display = 'none';
                }, 2000);
                return;
            }

            // æ£€æŸ¥æ˜¯å¦æ˜¯æ–°ç›®æ ‡ï¼ˆè¿™é‡Œæš‚æ—¶å‡è®¾éƒ½æ˜¯æ–°ç›®æ ‡ï¼Œåç»­å¯ä»¥æ ¹æ®å®é™…æƒ…å†µåˆ¤æ–­ï¼‰
            // TODO: ä»Botè·å–ç°æœ‰ç›®æ ‡åˆ—è¡¨ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºæ–°ç›®æ ‡
            const isNewTarget = true; // å ä½ç¬¦ï¼šå®é™…åº”è¯¥ä»Botè·å–

            if (isNewTarget) {
                // æ¢å¤æŒ‰é’®çŠ¶æ€
                confirmBtn.disabled = false;
                confirmBtn.style.opacity = '1';
                confirmBtn.style.cursor = 'pointer';
                statusCard.style.display = 'none';

                // æ˜¾ç¤ºæ¡£æ¡ˆåˆå§‹åŒ–å¼¹çª—
                showTargetCreationModal();
                return;
            }

            // ========== è·å–æ•°æ®ï¼šæ”¶é›†å½“å‰é€‰ä¸­çš„'å…³ç³»ç±»å‹'å’Œ'åšå¼ˆé˜¶æ®µ' ==========
            const dataToSend = {
                action: 'start_analysis',
                relationship: config.relationship,
                stage: config.stage,
                timestamp: Date.now()
            };

            // ========== è°ƒç”¨è§£å¯†åŠ¨ç”»ï¼šå…ˆè§¦å‘ startDecryption() åŠ¨ç”» ==========
            startDecryption();

            // ========== å‘é€å¹¶å…³é—­ï¼šåœ¨åŠ¨ç”»è¿è¡Œ 1.5 ç§’åï¼Œè°ƒç”¨ sendData ==========
            setTimeout(() => {
                // ä½¿ç”¨ window.Telegram.WebApp.sendData() å‘é€æ•°æ®
                // è¿™ä¼šè‡ªåŠ¨å…³é—­å°ç¨‹åºå¹¶å°†æ•°æ®å‘å›ç»™ Bot
                if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.sendData) {
                    try {
                        window.Telegram.WebApp.sendData(JSON.stringify(dataToSend));
                    } catch (error) {
                        console.error('å‘é€æ•°æ®å¤±è´¥:', error);

                        // åœæ­¢è§£å¯†åŠ¨ç”»
                        stopDecryption();

                        // æ˜¾ç¤ºé”™è¯¯æç¤º
                        statusCard.style.display = 'block';
                        statusText.textContent = t('status_failed');
                        statusText.className = 'text-sm text-red-400';

                        // æ¢å¤æŒ‰é’®çŠ¶æ€
                        setTimeout(() => {
                            statusCard.style.display = 'none';
                            confirmBtn.disabled = false;
                            confirmBtn.style.opacity = '1';
                            confirmBtn.style.cursor = 'pointer';
                        }, 2000);
                    }
                } else if (tg && tg.sendData) {
                    // å…¼å®¹æ—§ç‰ˆæœ¬çš„ Telegram WebApp API
                    try {
                        tg.sendData(JSON.stringify(dataToSend));
                    } catch (error) {
                        console.error('å‘é€æ•°æ®å¤±è´¥:', error);

                        // åœæ­¢è§£å¯†åŠ¨ç”»
                        stopDecryption();

                        // æ˜¾ç¤ºé”™è¯¯æç¤º
                        statusCard.style.display = 'block';
                        statusText.textContent = t('status_failed');
                        statusText.className = 'text-sm text-red-400';

                        // æ¢å¤æŒ‰é’®çŠ¶æ€
                        setTimeout(() => {
                            statusCard.style.display = 'none';
                            confirmBtn.disabled = false;
                            confirmBtn.style.opacity = '1';
                            confirmBtn.style.cursor = 'pointer';
                        }, 2000);
                    }
                } else {
                    // é Telegram ç¯å¢ƒï¼Œåœæ­¢è§£å¯†åŠ¨ç”»å¹¶æ˜¾ç¤ºæç¤º
                    stopDecryption();

                    statusCard.style.display = 'block';
                    statusText.textContent = t('status_not_telegram');
                    statusText.className = 'text-sm text-amber-400';

                    setTimeout(() => {
                        statusCard.style.display = 'none';
                        confirmBtn.disabled = false;
                        confirmBtn.style.opacity = '1';
                        confirmBtn.style.cursor = 'pointer';
                    }, 2000);
                }
            }, 1500); // 1.5 ç§’åå‘é€æ•°æ®
        });

        // å¤åˆ¶é‚€è¯·ç 
        const inviteCode = document.getElementById('inviteCode');
        const copyBtn = document.getElementById('copyBtn');

        // ç”Ÿæˆé‚€è¯·ç ï¼ˆåŸºäºç”¨æˆ·IDï¼‰
        if (initDataUnsafe.user) {
            const userId = initDataUnsafe.user.id;
            const code = `ECHO-${userId.toString(16).toUpperCase().slice(0, 4)}-${Date.now().toString(16).toUpperCase().slice(-4)}`;
            inviteCode.textContent = code;
        }

        copyBtn.addEventListener('click', async () => {
            // è§¦æ„Ÿåé¦ˆï¼ˆæˆåŠŸé€šçŸ¥ï¼‰
            hapticFeedback.notification('success');

            try {
                await navigator.clipboard.writeText(inviteCode.textContent);
                copyBtn.textContent = t('btn_copied');
                setTimeout(() => {
                    copyBtn.textContent = t('btn_copy');
                }, 2000);
            } catch (err) {
                console.error('å¤åˆ¶å¤±è´¥:', err);
            }
        });

        // å……å€¼æŒ‰é’®
        const rechargeButtons = document.querySelectorAll('[data-amount]');
        rechargeButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                const amount = btn.dataset.amount;

                // è§¦æ„Ÿåé¦ˆï¼ˆæˆåŠŸé€šçŸ¥ï¼‰
                hapticFeedback.notification('success');

                // å‘é€å……å€¼è¯·æ±‚
                if (tg && tg.sendData) {
                    const data = JSON.stringify({
                        action: 'recharge',
                        amount: parseInt(amount),
                        timestamp: Date.now()
                    });

                    tg.sendData(data);
                }

                // æ˜¾ç¤ºæç¤º
                statusCard.style.display = 'block';
                statusText.textContent = t('status_recharge', { amount: amount });
                statusText.className = 'text-sm text-amber-400';

                setTimeout(() => {
                    statusCard.style.display = 'none';
                }, 3000);
            });
        });

        // åˆå§‹åŒ–ç”¨æˆ·ä¿¡æ¯
        if (initDataUnsafe.user) {
            const user = initDataUnsafe.user;
            document.getElementById('userId').textContent = user.id || '-';

            // æ¨¡æ‹Ÿæ³¨å†Œæ—¶é—´ï¼ˆå®é™…åº”ä»æœåŠ¡å™¨è·å–ï¼‰
            const registerTime = new Date().toLocaleDateString('zh-CN');
            document.getElementById('registerTime').textContent = registerTime;
        }

        // ç›‘å¬æ¥è‡ª Bot çš„æ¶ˆæ¯ï¼ˆå¸¦å®‰å…¨æ£€æŸ¥ï¼‰
        if (tg && tg.onEvent) {
            tg.onEvent('viewportChanged', () => {
                console.log('Viewport changed');
            });
        }

        // é”™è¯¯å¤„ç†
        window.addEventListener('error', (e) => {
            console.error('Error:', e);
        });

        // ç”Ÿæˆç›®æ ‡å¡ç‰‡
        function createTargetCard(target) {
            const card = document.createElement('div');
            card.className = 'target-card';

            // çŠ¶æ€æ ‡ç­¾
            const statusClass = target.status === 'live' ? 'status-live' : 'status-archived';
            const statusText = target.status === 'live' ? t('status_live') : t('status_archived');
            const liveDot = target.status === 'live' ? '<span class="live-dot"></span>' : '';

            // ä¸»å¯¼æƒæŒ‡æ•°ï¼ˆ0-100ï¼‰
            const dominanceValue = target.dominance || 0;
            const dominanceColor = dominanceValue >= 70 ? '#06b6d4' : dominanceValue >= 40 ? '#f59e0b' : '#ef4444';

            // ç¿»è¯‘å…³ç³»ç±»å‹å’Œé˜¶æ®µï¼ˆå¤„ç†ä¸­è‹±æ–‡é”®åæ˜ å°„ï¼‰
            const relationshipMap = {
                'lover': 'relationship_lover',
                'ex': 'relationship_ex',
                'boss': 'relationship_boss',
                'colleague': 'relationship_colleague',
                'æƒ…ä¾£': 'relationship_lover',
                'å‰ä»»': 'relationship_ex',
                'ä¸Šå¸': 'relationship_boss',
                'åŒäº‹': 'relationship_colleague'
            };
            const stageMap = {
                'ambiguous': 'stage_ambiguous',
                'cold': 'stage_cold',
                'harvest': 'stage_harvest',
                'æš§æ˜§': 'stage_ambiguous',
                'å†·æˆ˜': 'stage_cold',
                'æ”¶å‰²': 'stage_harvest'
            };

            const relationshipKey = relationshipMap[target.relationship] || null;
            const stageKey = stageMap[target.stage] || null;

            // å¤„ç†è‡ªå®šä¹‰å…³ç³»ç±»å‹å’Œé˜¶æ®µï¼ˆå¦‚æœåŒ…å« custom: å‰ç¼€ï¼‰
            let relationshipText = relationshipKey ? t(relationshipKey) : (target.relationship || t('unclassified'));
            let stageText = stageKey ? t(stageKey) : (target.stage || t('not_set'));

            // å¦‚æœå…³ç³»ç±»å‹æˆ–é˜¶æ®µåŒ…å« custom: å‰ç¼€ï¼Œæå–è‡ªå®šä¹‰å€¼
            if (target.relationship && target.relationship.startsWith('custom:')) {
                relationshipText = target.relationship.replace('custom:', '');
            }
            if (target.stage && target.stage.startsWith('custom:')) {
                stageText = target.stage.replace('custom:', '');
            }

            // å›¾æ ‡é»˜è®¤å€¼ï¼šä¼˜å…ˆä½¿ç”¨ target.iconï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨ ğŸ‘¤ æˆ– ğŸ¯
            const defaultIcon = 'ğŸ‘¤'; // é»˜è®¤ä½¿ç”¨ ğŸ‘¤
            const targetIcon = target.icon || defaultIcon;

            card.innerHTML = `
                <div class="status-badge ${statusClass}">
                    ${liveDot}
                    <span>${statusText}</span>
                </div>
                <div class="target-card-header">
                    <div class="target-avatar">${targetIcon}</div>
                    <div class="target-info">
                        <div class="target-name">${target.name || target.alias || t('unknown_target')}</div>
                        <div class="target-meta">${relationshipText} Â· ${stageText}</div>
                    </div>
                </div>
                <div class="dominance-preview">
                    <div class="dominance-label">
                        <span>${t('dominance_label')}</span>
                        <span class="dominance-value">${dominanceValue}%</span>
                    </div>
                    <div class="dominance-bar">
                        <div class="dominance-fill" style="width: ${dominanceValue}%; background: linear-gradient(90deg, ${dominanceColor}, ${dominanceColor}dd);"></div>
                    </div>
                </div>
            `;

            // ç‚¹å‡»å¡ç‰‡äº‹ä»¶
            card.addEventListener('click', () => {
                hapticFeedback.impact('medium');
                // å‘é€æ•°æ®å› Botï¼Œè¯·æ±‚æŸ¥çœ‹è¯¦æƒ…
                if (tg && tg.sendData) {
                    const data = JSON.stringify({
                        action: 'view_target',
                        target_id: target.id,
                        timestamp: Date.now()
                    });
                    tg.sendData(data);
                }
            });

            return card;
        }

        // æ¸²æŸ“ç›®æ ‡åˆ—è¡¨
        function renderTargetList(targets) {
            const targetList = document.getElementById('targetList');

            if (!targets || targets.length === 0) {
                targetList.innerHTML = `
                    <div class="empty-archives">
                        <div class="empty-archives-icon">ğŸ“­</div>
                        <div class="empty-archives-text">${t('empty_archives')}</div>
                        <div class="empty-archives-hint">${t('empty_archives_hint')}</div>
                    </div>
                `;
                return;
            }

            targetList.innerHTML = '';
            targets.forEach(target => {
                const card = createTargetCard(target);
                targetList.appendChild(card);
            });
        }

        // ç¤ºä¾‹æ•°æ®ï¼ˆå®é™…åº”ä» Bot æˆ–æœåŠ¡å™¨è·å–ï¼‰
        // æ³¨æ„ï¼šname å­—æ®µä½¿ç”¨è‹±æ–‡å ä½ç¬¦ï¼Œå®é™…æ¸²æŸ“æ—¶ä¼šæ ¹æ® lang ç¯å¢ƒè¿›è¡Œç¿»è¯‘
        const sampleTargets = [
            {
                id: 1,
                name: 'Ex-A', // è‹±æ–‡å ä½ç¬¦ï¼Œå®é™…åº”ä»æ•°æ®åº“è·å– alias
                alias: 'Ex-A', // æ•°æ®åº“ä¸­çš„ alias å­—æ®µ
                icon: 'ğŸ’”',
                relationship: 'ex',
                stage: 'cold',
                status: 'live',
                dominance: 65
            },
            {
                id: 2,
                name: 'Colleague-B', // è‹±æ–‡å ä½ç¬¦
                alias: 'Colleague-B',
                icon: 'ğŸ‘”',
                relationship: 'colleague',
                stage: 'ambiguous',
                status: 'live',
                dominance: 45
            },
            {
                id: 3,
                name: 'Target-C', // è‹±æ–‡å ä½ç¬¦
                alias: 'Target-C',
                icon: 'ğŸ¯',
                relationship: 'lover',
                stage: 'harvest',
                status: 'archived',
                dominance: 85
            }
        ];

        // ç›‘å¬æ¥è‡ª Bot çš„æ•°æ®ï¼ˆå®é™…å®ç°ä¸­åº”è¯¥é€šè¿‡ Telegram WebApp æ¥æ”¶æ•°æ®ï¼‰
        // è¿™é‡Œå…ˆä½¿ç”¨ç¤ºä¾‹æ•°æ®
        if (tg && tg.onEvent) {
            tg.onEvent('mainButtonClicked', () => {
                // å½“ç”¨æˆ·ç‚¹å‡»ä¸»æŒ‰é’®æ—¶ï¼Œå¯ä»¥åˆ·æ–°åˆ—è¡¨
                renderTargetList(sampleTargets);
            });
        }

        // é¡µé¢åˆ‡æ¢æ—¶ï¼Œå¦‚æœæ˜¯æ¡£æ¡ˆé¡µé¢ï¼ŒåŠ è½½ç›®æ ‡åˆ—è¡¨
        navItems.forEach(item => {
            item.addEventListener('click', () => {
                const targetPage = item.dataset.page;
                if (targetPage === 'folder') {
                    // åˆ‡æ¢åˆ°æ¡£æ¡ˆé¡µé¢æ—¶ï¼ŒåŠ è½½ç›®æ ‡åˆ—è¡¨
                    // å®é™…åº”è¯¥ä» Bot è·å–æ•°æ®ï¼Œè¿™é‡Œä½¿ç”¨ç¤ºä¾‹æ•°æ®
                    setTimeout(() => {
                        renderTargetList(sampleTargets);
                    }, 300);
                }
            });
        });

        // åˆå§‹åŒ–ï¼šå¦‚æœå½“å‰æ˜¯æ¡£æ¡ˆé¡µé¢ï¼ŒåŠ è½½æ•°æ®
        if (document.getElementById('page-folder').classList.contains('active')) {
            renderTargetList(sampleTargets);
        }

        // DOM åŠ è½½å®Œæˆååˆå§‹åŒ– i18n
        function initUI() {
            initI18n();

            // ==================== æ ¹æ® Telegram ç”¨æˆ·è¯­è¨€æ›´æ–° UI ====================
            // è·å– Telegram ç”¨æˆ·çš„è¯­è¨€è®¾ç½®
            const userLanguage = window.Telegram?.WebApp?.initDataUnsafe?.user?.language_code || 'en';

            const simpleTranslations = {
                'zh': { title: "æ¸¸æˆé…ç½®", button: "å¼€å§‹åˆ†æ" },
                'en': { title: "Game Configuration", button: "Start Analysis" }
            };

            // æ ¹æ®è¯­è¨€æ›´æ–° UI
            const lang = userLanguage.startsWith('zh') ? 'zh' : 'en';
            const titleElement = document.querySelector('h2[data-i18n="page_title_config"]');
            const buttonElement = document.querySelector('#confirmBtn span[data-i18n="btn_start_analysis"]');

            if (titleElement && simpleTranslations[lang]) {
                titleElement.innerText = simpleTranslations[lang].title;
            }
            if (buttonElement && simpleTranslations[lang]) {
                buttonElement.innerText = simpleTranslations[lang].button;
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initUI);
        } else {
            // DOM å·²ç»åŠ è½½å®Œæˆ
            initUI();
        }

        // ==================== æ¡£æ¡ˆåˆå§‹åŒ–å¼¹çª—ç›¸å…³å‡½æ•° ====================
        let currentSelectedIcon = 'ğŸ¯'; // é»˜è®¤å›¾æ ‡

        // æ˜¾ç¤ºæ¡£æ¡ˆåˆå§‹åŒ–å¼¹çª—
        function showTargetCreationModal() {
            const modal = document.getElementById('targetCreationModal');
            const nameInput = document.getElementById('targetNameInput');
            const iconSelector = document.getElementById('targetIconSelector');
            const selectedIcon = document.getElementById('selectedIcon');

            // é‡ç½®è¡¨å•
            nameInput.value = t('new_target_default_name');
            currentSelectedIcon = 'ğŸ¯';
            selectedIcon.textContent = 'ğŸ¯';
            document.getElementById('targetNameError').classList.add('hidden');
            document.getElementById('targetIconError').classList.add('hidden');

            // æ˜¾ç¤ºå¼¹çª—
            modal.classList.remove('hidden');

            // éšè—ä¸»æŒ‰é’®ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            if (tg && tg.MainButton) {
                tg.MainButton.hide();
            }
        }

        // éšè—æ¡£æ¡ˆåˆå§‹åŒ–å¼¹çª—
        function hideTargetCreationModal() {
            const modal = document.getElementById('targetCreationModal');
            modal.classList.add('hidden');

            // æ˜¾ç¤ºä¸»æŒ‰é’®ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
            if (tg && tg.MainButton) {
                tg.MainButton.show();
            }
        }

        // å–æ¶ˆåˆ›å»ºæ¡£æ¡ˆ
        document.getElementById('cancelTargetCreation').addEventListener('click', () => {
            hapticFeedback.impact('light');
            hideTargetCreationModal();
            showToast(t('target_creation_cancelled'), 'info');

            // å‘é€å–æ¶ˆæ¶ˆæ¯åˆ°Bot
            if (tg && tg.sendData) {
                tg.sendData(JSON.stringify({
                    action: 'cancel_target_creation',
                    timestamp: Date.now()
                }));
            }
        });

        // ç¡®è®¤åˆ›å»ºæ¡£æ¡ˆ
        document.getElementById('confirmTargetCreation').addEventListener('click', async () => {
            hapticFeedback.impact('medium');
            const targetName = document.getElementById('targetNameInput').value.trim();
            const targetIcon = currentSelectedIcon;

            let isValid = true;

            // éªŒè¯åç§°
            if (!targetName || targetName.length === 0 || targetName.length > 20) {
                document.getElementById('targetNameError').classList.remove('hidden');
                isValid = false;
            } else {
                document.getElementById('targetNameError').classList.add('hidden');
            }

            // éªŒè¯å›¾æ ‡ï¼ˆç®€å•æ£€æŸ¥ï¼Œæ›´ä¸¥æ ¼çš„éªŒè¯å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼‰
            if (!targetIcon || !/\p{Emoji}/u.test(targetIcon)) {
                document.getElementById('targetIconError').classList.remove('hidden');
                isValid = false;
            } else {
                document.getElementById('targetIconError').classList.add('hidden');
            }

            if (!isValid) {
                return;
            }

            // å‘é€æ•°æ®åˆ°Botåˆ›å»ºæ–°ç›®æ ‡
            if (tg && tg.sendData) {
                const data = JSON.stringify({
                    action: 'create_new_target',
                    alias: targetName,
                    icon: targetIcon,
                    relationship: config.relationship,
                    stage: config.stage,
                    timestamp: Date.now()
                });

                try {
                    tg.sendData(data);
                    showToast(t('miniapp_target_created', { alias: targetName, icon: targetIcon }), 'success');
                    hideTargetCreationModal();

                    // å»¶è¿Ÿåå‘é€åˆ†æé…ç½®å¹¶æ˜¾ç¤ºè§£å¯†åŠ¨ç”»
                    setTimeout(() => {
                        // ========== è·å–æ•°æ®ï¼šæ”¶é›†å½“å‰é€‰ä¸­çš„'å…³ç³»ç±»å‹'å’Œ'åšå¼ˆé˜¶æ®µ' ==========
                        const analysisData = {
                            action: 'start_analysis',
                            relationship: config.relationship,
                            stage: config.stage,
                            timestamp: Date.now()
                        };

                        // ========== è°ƒç”¨è§£å¯†åŠ¨ç”»ï¼šå…ˆè§¦å‘ startDecryption() åŠ¨ç”» ==========
                        startDecryption();

                        // ========== å‘é€å¹¶å…³é—­ï¼šåœ¨åŠ¨ç”»è¿è¡Œ 1.5 ç§’åï¼Œè°ƒç”¨ sendData ==========
                        setTimeout(() => {
                            // ä½¿ç”¨ window.Telegram.WebApp.sendData() å‘é€æ•°æ®
                            // è¿™ä¼šè‡ªåŠ¨å…³é—­å°ç¨‹åºå¹¶å°†æ•°æ®å‘å›ç»™ Bot
                            if (window.Telegram && window.Telegram.WebApp && window.Telegram.WebApp.sendData) {
                                try {
                                    window.Telegram.WebApp.sendData(JSON.stringify(analysisData));
                                } catch (error) {
                                    console.error('å‘é€æ•°æ®å¤±è´¥:', error);
                                    stopDecryption();
                                    showToast(t('status_failed'), 'error');
                                }
                            } else if (tg && tg.sendData) {
                                // å…¼å®¹æ—§ç‰ˆæœ¬çš„ Telegram WebApp API
                                try {
                                    tg.sendData(JSON.stringify(analysisData));
                                } catch (error) {
                                    console.error('å‘é€æ•°æ®å¤±è´¥:', error);
                                    stopDecryption();
                                    showToast(t('status_failed'), 'error');
                                }
                            } else {
                                stopDecryption();
                                showToast(t('status_not_telegram'), 'error');
                            }
                        }, 1500); // 1.5 ç§’åå‘é€æ•°æ®
                    }, 500);
                } catch (error) {
                    console.error('å‘é€æ•°æ®å¤±è´¥:', error);
                    showToast(t('miniapp_target_creation_failed'), 'error');
                }
            }
        });

        // å›¾æ ‡é€‰æ‹©å™¨ç‚¹å‡»äº‹ä»¶
        document.getElementById('targetIconSelector').addEventListener('click', () => {
            hapticFeedback.impact('light');
            showEmojiPicker();
        });

        // ==================== Emoji é€‰æ‹©å™¨ç›¸å…³å‡½æ•° ====================
        // å¸¸ç”¨Emojiåˆ—è¡¨ï¼ˆç®€åŒ–ç‰ˆï¼Œå®é™…å¯ä»¥ä½¿ç”¨æ›´å®Œæ•´çš„Emojiåº“ï¼‰
        const emojiCategories = {
            recent: ['ğŸ¯', 'ğŸ’”', 'ğŸ‘”', 'ğŸ’¼', 'ğŸ¤', 'ğŸ˜ˆ', 'ğŸ˜‡', 'ğŸ¤«', 'ğŸ‘€', 'ğŸ’¬'],
            people: ['ğŸ˜€', 'ğŸ˜‚', 'ğŸ˜', 'ğŸ¤”', 'ğŸ˜', 'ğŸ˜’', 'ğŸ˜”', 'ğŸ˜¢', 'ğŸ˜¡', 'ğŸ˜ˆ', 'ğŸ˜‡', 'ğŸ‘½', 'ğŸ¤–', 'ğŸ‘‹', 'ğŸ‘', 'ğŸ‘', 'ğŸ‘', 'ğŸ™', 'ğŸ’ª', 'ğŸ‘€', 'ğŸ§ ', 'ğŸ—£ï¸', 'ğŸ‘¤', 'ğŸ‘¥'],
            animals: ['ğŸ¶', 'ğŸ±', 'ğŸ­', 'ğŸ¹', 'ğŸ°', 'ğŸ¦Š', 'ğŸ»', 'ğŸ¼', 'ğŸ¨', 'ğŸ¯', 'ğŸ¦', 'ğŸ®', 'ğŸ·', 'ğŸ¸', 'ğŸ’', 'ğŸ”', 'ğŸ§', 'ğŸ¦', 'ğŸ¦…', 'ğŸ¦‰'],
            objects: ['âŒš', 'ğŸ“±', 'ğŸ’»', 'âŒ¨ï¸', 'ğŸ–¥ï¸', 'ğŸ–¨ï¸', 'ğŸ–±ï¸', 'ğŸ–²ï¸', 'ğŸ•¹ï¸', 'ğŸ—œï¸', 'ğŸ’½', 'ğŸ’¾', 'ğŸ’¿', 'ğŸ“€', 'ğŸ”‹', 'ğŸ”Œ', 'ğŸ’¡', 'ğŸ”¦', 'ğŸ•¯ï¸', 'ğŸ—‘ï¸'],
            symbols: ['â¤ï¸', 'ğŸ’”', 'ğŸ”¥', 'ğŸ’¯', 'âœ¨', 'â­', 'ğŸŒŸ', 'ğŸ’«', 'âš¡', 'ğŸ’¥', 'ğŸ¯', 'ğŸ²', 'ğŸ®', 'ğŸ°', 'ğŸª', 'ğŸ­', 'ğŸ¨', 'ğŸ–¼ï¸', 'ğŸ“', 'ğŸ—ºï¸'],
            food: ['ğŸ', 'ğŸ', 'ğŸŠ', 'ğŸ‹', 'ğŸŒ', 'ğŸ‰', 'ğŸ‡', 'ğŸ“', 'ğŸ’', 'ğŸ‘', 'ğŸ', 'ğŸ¥', 'ğŸ¥­', 'ğŸ¥‘', 'ğŸ†', 'ğŸ¥”', 'ğŸ¥•', 'ğŸŒ½', 'ğŸŒ¶ï¸', 'ğŸ¥’'],
            travel: ['ğŸš—', 'ğŸš•', 'ğŸš™', 'ğŸšŒ', 'ğŸš', 'ğŸï¸', 'ğŸš“', 'ğŸš‘', 'ğŸš’', 'ğŸš', 'ğŸšš', 'ğŸš›', 'ğŸšœ', 'ğŸš²', 'ğŸ›µ', 'ğŸï¸', 'ğŸš„', 'ğŸš…', 'ğŸš†', 'ğŸš‡'],
            flags: ['ğŸ', 'ğŸš©', 'ğŸŒ', 'ğŸ´', 'ğŸ³ï¸', 'ğŸ³ï¸â€ğŸŒˆ', 'ğŸ³ï¸â€âš§ï¸', 'ğŸ‡ºğŸ‡³', 'ğŸ‡¦ğŸ‡«', 'ğŸ‡¦ğŸ‡½', 'ğŸ‡¦ğŸ‡±', 'ğŸ‡©ğŸ‡¿', 'ğŸ‡¦ğŸ‡¸', 'ğŸ‡¦ğŸ‡©', 'ğŸ‡¦ğŸ‡´', 'ğŸ‡¦ğŸ‡®', 'ğŸ‡¦ğŸ‡¶', 'ğŸ‡¦ğŸ‡¬', 'ğŸ‡¦ğŸ‡·', 'ğŸ‡¦ğŸ‡²']
        };

        // æ˜¾ç¤ºEmojié€‰æ‹©å™¨
        function showEmojiPicker() {
            const modal = document.getElementById('emojiPickerModal');
            const emojiList = document.getElementById('emojiList');
            const emojiCategoriesDiv = document.getElementById('emojiCategories');

            // æ¸…ç©ºåˆ—è¡¨
            emojiList.innerHTML = '';
            emojiCategoriesDiv.innerHTML = '';

            // æ·»åŠ åˆ†ç±»æŒ‰é’®
            Object.keys(emojiCategories).forEach(category => {
                const btn = document.createElement('button');
                btn.className = 'btn-secondary text-xs px-3 py-1';
                btn.textContent = t(`miniapp_target_creation_icon_picker_${category}`) || category;
                btn.addEventListener('click', () => {
                    hapticFeedback.impact('light');
                    loadEmojiCategory(category);
                });
                emojiCategoriesDiv.appendChild(btn);
            });

            // é»˜è®¤åŠ è½½æœ€è¿‘ä½¿ç”¨çš„
            loadEmojiCategory('recent');

            // æ˜¾ç¤ºå¼¹çª—
            modal.classList.remove('hidden');
        }

        // åŠ è½½Emojiåˆ†ç±»
        function loadEmojiCategory(category) {
            const emojiList = document.getElementById('emojiList');
            const emojis = emojiCategories[category] || [];

            emojiList.innerHTML = '';

            emojis.forEach(emoji => {
                const emojiBtn = document.createElement('button');
                emojiBtn.className = 'text-2xl p-2 hover:bg-gray-700 rounded-lg transition-colors cursor-pointer';
                emojiBtn.textContent = emoji;
                emojiBtn.addEventListener('click', () => {
                    hapticFeedback.impact('light');
                    selectEmoji(emoji);
                });
                emojiList.appendChild(emojiBtn);
            });
        }

        // é€‰æ‹©Emoji
        function selectEmoji(emoji) {
            currentSelectedIcon = emoji;
            document.getElementById('selectedIcon').textContent = emoji;
            hideEmojiPicker();
        }

        // éšè—Emojié€‰æ‹©å™¨
        function hideEmojiPicker() {
            const modal = document.getElementById('emojiPickerModal');
            modal.classList.add('hidden');
        }

        // å…³é—­Emojié€‰æ‹©å™¨
        document.getElementById('closeEmojiPicker').addEventListener('click', () => {
            hapticFeedback.impact('light');
            hideEmojiPicker();
        });

        // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­ï¼ˆå¯é€‰ï¼‰
        document.getElementById('emojiPickerModal').addEventListener('click', (e) => {
            if (e.target.id === 'emojiPickerModal') {
                hideEmojiPicker();
            }
        });

        document.getElementById('targetCreationModal').addEventListener('click', (e) => {
            if (e.target.id === 'targetCreationModal') {
                hideTargetCreationModal();
            }
        });

        // Emojiæœç´¢åŠŸèƒ½ï¼ˆç®€åŒ–ç‰ˆï¼‰
        document.getElementById('emojiSearchInput').addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const emojiList = document.getElementById('emojiList');
            const noResults = document.getElementById('noEmojiResults');

            if (!searchTerm) {
                loadEmojiCategory('recent');
                noResults.classList.add('hidden');
                return;
            }

            // æœç´¢æ‰€æœ‰åˆ†ç±»
            const allEmojis = Object.values(emojiCategories).flat();
            const filtered = allEmojis.filter(emoji => {
                // ç®€å•çš„æœç´¢é€»è¾‘ï¼ˆå¯ä»¥æ ¹æ®éœ€è¦æ”¹è¿›ï¼‰
                return emoji.includes(searchTerm) || searchTerm.includes(emoji);
            });

            emojiList.innerHTML = '';

            if (filtered.length === 0) {
                noResults.classList.remove('hidden');
            } else {
                noResults.classList.add('hidden');
                filtered.forEach(emoji => {
                    const emojiBtn = document.createElement('button');
                    emojiBtn.className = 'text-2xl p-2 hover:bg-gray-700 rounded-lg transition-colors cursor-pointer';
                    emojiBtn.textContent = emoji;
                    emojiBtn.addEventListener('click', () => {
                        hapticFeedback.impact('light');
                        selectEmoji(emoji);
                    });
                    emojiList.appendChild(emojiBtn);
                });
            }
        });

        // ç®€å•çš„Toastæç¤ºå‡½æ•°ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰
        function showToast(message, type = 'info') {
            // ç®€å•çš„å®ç°ï¼Œå¯ä»¥åç»­æ”¹è¿›
            const statusCard = document.getElementById('statusCard');
            const statusText = document.getElementById('statusText');

            if (statusCard && statusText) {
                statusCard.style.display = 'block';
                statusText.textContent = message;

                const typeClasses = {
                    'success': 'text-sm text-cyan-400',
                    'error': 'text-sm text-red-400',
                    'info': 'text-sm text-amber-400'
                };
                statusText.className = typeClasses[type] || 'text-sm text-gray-400';

                setTimeout(() => {
                    statusCard.style.display = 'none';
                }, 3000);
            } else {
                console.log(`[${type.toUpperCase()}] ${message}`);
            }
        }

        // ==================== æƒ…æŠ¥è§£å¯†åŠ è½½åŠ¨ç”»ç›¸å…³å‡½æ•° ====================
        let loadingAnimationInterval = null;
        let percentageAnimationInterval = null;
        let decryptingScrambleInterval = null;

        // ç”Ÿæˆéšæœºåå…­è¿›åˆ¶ä»£ç 
        function generateHexCode() {
            const chars = '0123456789ABCDEF';
            let hex = '';
            for (let i = 0; i < 8; i++) {
                hex += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return hex;
        }

        // æ›´æ–°åå…­è¿›åˆ¶ä»£ç æµ
        function updateHexStreams() {
            const streams = ['hexStream1', 'hexStream2', 'hexStream3'];
            streams.forEach(streamId => {
                const stream = document.getElementById(streamId);
                if (stream) {
                    let hexCodes = '';
                    for (let i = 0; i < 20; i++) {
                        hexCodes += generateHexCode() + ' ';
                    }
                    stream.textContent = hexCodes;
                }
            });
        }

        // æ–‡å­—æ··æ·†æ•ˆæœï¼ˆDECRYPTINGï¼‰
        function scrambleText(element, targetText, duration = 2000) {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_';
            const originalText = targetText;
            let startTime = Date.now();
            let scrambleCount = 0;
            const maxScrambles = 30;

            const scramble = () => {
                if (scrambleCount >= maxScrambles) {
                    element.textContent = `[ ${originalText}... ]`;
                    return;
                }

                let scrambled = '';
                for (let i = 0; i < originalText.length; i++) {
                    if (Math.random() > 0.3) {
                        scrambled += chars.charAt(Math.floor(Math.random() * chars.length));
                    } else {
                        scrambled += originalText[i];
                    }
                }
                element.textContent = `[ ${scrambled}... ]`;
                scrambleCount++;

                if (scrambleCount < maxScrambles) {
                    setTimeout(scramble, duration / maxScrambles);
                }
            };

            scramble();
        }

        // ç™¾åˆ†æ¯”åŠ¨ç”»ï¼ˆéçº¿æ€§ï¼Œå…ˆå¿«åæ…¢ï¼‰
        function animatePercentage(element, targetPercent = 99, duration = 3000) {
            let startTime = Date.now();
            let currentPercent = 0;

            const update = () => {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);

                // éçº¿æ€§ç¼“åŠ¨å‡½æ•°ï¼ˆease-outï¼‰
                const easeOut = 1 - Math.pow(1 - progress, 3);
                currentPercent = Math.floor(easeOut * targetPercent);

                if (element) {
                    element.textContent = currentPercent;
                }

                if (progress < 1) {
                    requestAnimationFrame(update);
                } else {
                    if (element) {
                        element.textContent = targetPercent;
                    }
                }
            };

            update();
        }

        // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
        function showLoadingAnimation() {
            const overlay = document.getElementById('loading-overlay');
            const decryptingText = document.getElementById('decryptingText');
            const securityBypass = document.getElementById('securityBypass');
            const bypassPercent = document.getElementById('bypassPercent');

            if (!overlay) return;

            // æ˜¾ç¤ºé®ç½©å±‚
            overlay.classList.remove('hidden');

            // æ›´æ–°æ–‡æœ¬ï¼ˆå¤šè¯­è¨€ï¼‰
            const decryptingSignal = t('loading_decrypting_signal');
            const securityBypassText = t('loading_security_bypass');

            if (securityBypass) {
                securityBypass.innerHTML = `${securityBypassText}: <span id="bypassPercent">0</span>%`;
            }

            // åˆå§‹åŒ–åå…­è¿›åˆ¶ä»£ç æµ
            updateHexStreams();
            const hexUpdateInterval = setInterval(updateHexStreams, 2000);

            // æ–‡å­—æ··æ·†æ•ˆæœ
            if (decryptingText) {
                scrambleText(decryptingText, decryptingSignal, 2000);
            }

            // ç™¾åˆ†æ¯”åŠ¨ç”»ï¼ˆå»¶è¿Ÿä¸€ç‚¹ç¡®ä¿DOMå·²æ›´æ–°ï¼‰
            setTimeout(() => {
                const percentElement = document.getElementById('bypassPercent');
                if (percentElement) {
                    animatePercentage(percentElement, 99, 3000);
                }
            }, 100);

            // ä¿å­˜intervalä»¥ä¾¿æ¸…ç†
            loadingAnimationInterval = hexUpdateInterval;

            // è§¦æ„Ÿåé¦ˆ
            hapticFeedback.impact('heavy');
        }

        // éšè—åŠ è½½åŠ¨ç”»
        function hideLoadingAnimation() {
            const overlay = document.getElementById('loading-overlay');
            if (!overlay) return;

            // æ¸…ç†æ‰€æœ‰interval
            if (loadingAnimationInterval) {
                clearInterval(loadingAnimationInterval);
                loadingAnimationInterval = null;
            }
            if (percentageAnimationInterval) {
                clearInterval(percentageAnimationInterval);
                percentageAnimationInterval = null;
            }
            if (decryptingScrambleInterval) {
                clearInterval(decryptingScrambleInterval);
                decryptingScrambleInterval = null;
            }

            // æ·¡å‡ºåŠ¨ç”»
            overlay.style.transition = 'opacity 0.5s ease';
            overlay.style.opacity = '0';

            setTimeout(() => {
                overlay.classList.add('hidden');
                overlay.style.opacity = '';
            }, 500);
        }

        // å¯¼å‡ºå‡½æ•°ä¾›å¤–éƒ¨è°ƒç”¨ï¼ˆå½“AIå›å¤æ—¶å…³é—­ï¼‰
        window.hideLoadingAnimation = hideLoadingAnimation;

        // ==================== æƒ…æŠ¥è§£å¯†å…¨å±åŠ è½½æ•ˆæœç›¸å…³å‡½æ•° ====================
        let decryptScrambleInterval = null;
        let decryptProgressInterval = null;
        let decryptAnimationFrame = null;

        // å­—ç¬¦æ··æ·†å‡½æ•°ï¼ˆScrambleï¼‰
        function scrambleText(element, targetText, duration = 2000) {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+-=[]{}|;:,.<>?';
            const originalText = targetText;
            let startTime = Date.now();
            let scrambleCount = 0;
            const maxScrambles = 40;
            const interval = duration / maxScrambles;

            const scramble = () => {
                if (scrambleCount >= maxScrambles) {
                    element.textContent = originalText;
                    return;
                }

                let scrambled = '';
                for (let i = 0; i < originalText.length; i++) {
                    if (Math.random() > 0.25) {
                        scrambled += chars.charAt(Math.floor(Math.random() * chars.length));
                    } else {
                        scrambled += originalText[i];
                    }
                }
                element.textContent = scrambled;
                scrambleCount++;

                if (scrambleCount < maxScrambles) {
                    setTimeout(scramble, interval);
                }
            };

            scramble();
        }

        // éçº¿æ€§è¿›åº¦åŠ¨ç”»ï¼ˆ0% -> å¿«é€Ÿåˆ°75% -> ç¼“æ…¢åˆ°99%ï¼‰
        function animateDecryptProgress(element, duration = 3000) {
            let startTime = Date.now();
            let currentPercent = 0;

            const update = () => {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1);

                // éçº¿æ€§ç¼“åŠ¨ï¼šå‰60%å¿«é€Ÿåˆ°75%ï¼Œå40%ç¼“æ…¢åˆ°99%
                let easeProgress;
                if (progress < 0.6) {
                    // å‰60%ï¼šå¿«é€Ÿåˆ°75%ï¼ˆä½¿ç”¨ease-out cubicï¼‰
                    const fastProgress = progress / 0.6;
                    easeProgress = 1 - Math.pow(1 - fastProgress, 3);
                    currentPercent = Math.floor(easeProgress * 75);
                } else {
                    // å40%ï¼šç¼“æ…¢åˆ°99%ï¼ˆä½¿ç”¨ease-in-outï¼‰
                    const slowProgress = (progress - 0.6) / 0.4;
                    const easeInOut = slowProgress < 0.5 
                        ? 2 * slowProgress * slowProgress 
                        : 1 - Math.pow(-2 * slowProgress + 2, 3) / 2;
                    currentPercent = Math.floor(75 + easeInOut * 24);
                }

                if (element) {
                    element.textContent = currentPercent;
                }

                if (progress < 1) {
                    decryptAnimationFrame = requestAnimationFrame(update);
                } else {
                    if (element) {
                        element.textContent = 99;
                    }
                }
            };

            update();
        }

        // å¯åŠ¨æƒ…æŠ¥è§£å¯†åŠ¨ç”»
        function startDecryption() {
            const overlay = document.getElementById('decrypt-overlay');
            const signalElement = document.getElementById('decryptSignal');
            const scrambleElement = document.getElementById('decryptScramble');
            const progressElement = document.getElementById('decryptPercent');

            if (!overlay) return;

            // æ˜¾ç¤ºé®ç½©å±‚
            overlay.classList.remove('hidden');

            // æ›´æ–°æ–‡æœ¬ï¼ˆå¤šè¯­è¨€ï¼‰
            const signalText = t('decrypt_signal_searching');
            const decryptingText = t('decrypt_decrypting');

            if (signalElement) {
                signalElement.textContent = `[ ${signalText}... ]`;
            }

            if (progressElement) {
                progressElement.textContent = '0';
            }

            // å­—ç¬¦æ··æ·†åŠ¨ç”»
            if (scrambleElement) {
                // æŒç»­æ··æ·†ï¼Œç›´åˆ°åœæ­¢
                let scrambleCount = 0;
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+-=[]{}|;:,.<>?';

                decryptScrambleInterval = setInterval(() => {
                    let scrambled = '';
                    for (let i = 0; i < decryptingText.length; i++) {
                        if (Math.random() > 0.2) {
                            scrambled += chars.charAt(Math.floor(Math.random() * chars.length));
                        } else {
                            scrambled += decryptingText[i];
                        }
                    }
                    scrambleElement.textContent = scrambled;
                    scrambleCount++;
                }, 50); // æ¯50msæ›´æ–°ä¸€æ¬¡
            }

            // éçº¿æ€§è¿›åº¦åŠ¨ç”»
            if (progressElement) {
                animateDecryptProgress(progressElement, 3000);
            }

            // æ‰‹æœºéœ‡åŠ¨
            hapticFeedback.impact('heavy');

            // å¦‚æœæ”¯æŒéœ‡åŠ¨APIï¼Œä¹Ÿè°ƒç”¨åŸç”Ÿéœ‡åŠ¨
            if (navigator.vibrate) {
                navigator.vibrate(200);
            }
        }

        // åœæ­¢è§£å¯†åŠ¨ç”»
        function stopDecryption() {
            const overlay = document.getElementById('decrypt-overlay');
            if (!overlay) return;

            // æ¸…ç†æ‰€æœ‰åŠ¨ç”»
            if (decryptScrambleInterval) {
                clearInterval(decryptScrambleInterval);
                decryptScrambleInterval = null;
            }
            if (decryptProgressInterval) {
                clearInterval(decryptProgressInterval);
                decryptProgressInterval = null;
            }
            if (decryptAnimationFrame) {
                cancelAnimationFrame(decryptAnimationFrame);
                decryptAnimationFrame = null;
            }

            // é”å®šæœ€ç»ˆæ–‡æœ¬
            const scrambleElement = document.getElementById('decryptScramble');
            if (scrambleElement) {
                scrambleElement.textContent = t('decrypt_decrypting');
            }

            const progressElement = document.getElementById('decryptPercent');
            if (progressElement) {
                progressElement.textContent = '99';
            }

            // 0.5sæ¸éšåŠ¨ç”»
            overlay.style.transition = 'opacity 0.5s ease';
            overlay.style.opacity = '0';

            setTimeout(() => {
                overlay.classList.add('hidden');
                overlay.style.opacity = '';
                overlay.style.transition = '';
            }, 500);
        }

        // å¯¼å‡ºå‡½æ•°ä¾›å¤–éƒ¨è°ƒç”¨
        window.startDecryption = startDecryption;
        window.stopDecryption = stopDecryption;
    </script>
</body>
</html>